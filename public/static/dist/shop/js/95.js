(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[95],{"0e507":function(t,e,n){"use strict";var i=n("a2d9");n.o(i,"render")&&n.d(e,"render",(function(){return i["render"]})),n.o(i,"staticRenderFns")&&n.d(e,"staticRenderFns",(function(){return i["staticRenderFns"]}))},3107:function(t,e,n){"use strict";var i=n("92ba");n.o(i,"render")&&n.d(e,"render",(function(){return i["render"]})),n.o(i,"staticRenderFns")&&n.d(e,"staticRenderFns",(function(){return i["staticRenderFns"]}))},"405c":function(t,e,n){},"4eaf":function(t,e,n){},"52a9":function(t,e,n){"use strict";n("4eaf")},5511:function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("d3b7"),n("159b"),n("b0c0"),n("ac1f"),n("841c"),n("14d9"),n("d81d"),n("4de4"),n("9911");var i={name:"LinkSelector",props:{current:{type:[Object,String],required:!0},value:{type:Boolean,default:!1}},data:function(){return{name:"shop",search:{content:""},data:[],list:[],selectRow:null,loading:!1,link:"",keyword:["shop","goods","member"]}},methods:{handleSearch:function(){var t=this,e=[];this.data.forEach((function(n){var i;if(n.name.indexOf(t.search.content)>-1)e.push(n);else if(null!==(i=n.links)&&void 0!==i&&i.length){var a=[];n.links.forEach((function(e){e.name.indexOf(t.search.content)>-1&&a.push(e)})),a.length>0&&e.push({item:n,links:a})}})),this.list=e},defaultChecked:function(){var t=this;this.list.forEach((function(e,n){e.links&&e.links.length>0&&e.links.forEach((function(e,i){var a;e.url===(null===(a=t.selectRow)||void 0===a?void 0:a.url)?t.$set(t.list[n].links[i],"checked",!0):t.$set(t.list[n].links[i],"checked",!1)}))}))},setChecked:function(t,e){var n=this,i=this.list[t].links[e];i.checked?(this.selectRow={},this.$set(this.list[t].links[e],"checked",!1)):(this.list.forEach((function(t,e){t.links.forEach((function(t,i){n.$set(n.list[e].links[i],"checked",!1)}))})),this.$set(this.list[t].links[e],"checked",!0),this.selectRow=this.list[t].links[e])},getData:function(){var t=this;this.loading=!0,this.$api.shopApi.getLinkList().then((function(e){t.loading=!1,0===e.error&&(t.data=e.list.map((function(t){return t.links=t.links.filter((function(t){return"wx_service"!=t.url})),t})),t.list=t.data,t.defaultChecked())}))},handleSave:function(){"custom"===this.name?this.$emit("on-change",{url:this.link}):this.$emit("on-change",this.selectRow),this.handleCancel()},handleCancel:function(){this.$emit("on-cancel")}},watch:{value:{handler:function(t){t&&(this.getData(),this.current?"string"===typeof this.current?this.selectRow={url:this.current}:this.selectRow=this.current:this.selectRow={},this.name="shop",this.link="",this.search.content="")},immediate:!0}}};e.default=i},"55f7":function(t,e,n){"use strict";n("ce9b")},"7c61":function(t,e,n){"use strict";n("405c")},"92ba":function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.staticRenderFns=e.render=void 0,n("b0c0"),n("ac1f"),n("841c"),n("9911");var i=function(){var t=this,e=t._self._c;return e("kdx-modal-frame",{attrs:{value:t.value,title:"链接选择器",width:"1000",loading:t.loading,"ok-text":"保存"},on:{"on-ok":t.handleSave,"on-cancel":t.handleCancel}},[e("div",{staticClass:"selector-shopping-mall"},[e("Tabs",{model:{value:t.name,callback:function(e){t.name=e},expression:"name"}},[e("TabPane",{attrs:{label:"商城链接",name:"shop"}},[e("div",{staticClass:"shopping-mall-link"},[e("div",{staticClass:"search"},[e("Input",{staticClass:"width-300",attrs:{search:"","enter-button":"搜索",placeholder:"请输入"},on:{"on-search":t.handleSearch},model:{value:t.search.content,callback:function(e){t.$set(t.search,"content",e)},expression:"search.content"}})],1),t.list&&t.list.length>0?e("div",{staticClass:"content"},t._l(t.list,(function(n,i){return e("div",{key:i,staticClass:"content-item"},[e("p",{staticClass:"title"},[t._v(" "+t._s(n.name)+" ")]),n.links&&n.links.length>0?e("ul",t._l(n.links,(function(n,a){return e("li",{key:a,class:{checked:n.checked},on:{click:function(e){return t.setChecked(i,a)}}},[e("Icon",{attrs:{type:n.icon}}),e("span",{staticClass:"name"},[t._v(t._s(n.name))])],1)})),0):t._e()])})),0):e("div",{staticStyle:{"text-align":"center"}},[t._v("暂无数据")])])]),e("TabPane",{attrs:{label:"自定义链接",name:"custom"}},[e("div",{staticClass:"image-selector-network"},[e("Form",{staticClass:"custom-link",attrs:{"label-width":120},nativeOn:{submit:function(t){t.preventDefault()}}},[e("FormItem",{attrs:{label:"链接地址："}},[e("Input",{attrs:{"enter-button":"提取链接",search:"",placeholder:"请输入"},on:{"on-search":t.handleSave},model:{value:t.link,callback:function(e){t.link=e},expression:"link"}})],1)],1)],1)])],1)],1)])};e.render=i;var a=[];e.staticRenderFns=a},9688:function(t,e,n){var i=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("14d9");var a=i(n("a58b")),s={name:"index",components:{LinkSelector:a.default},data:function(){return{model:{advurl:"",advimg:""},advertising:{value:!1},id:0,loading:!1}},methods:{changeAdvertising:function(t){this.model.advimg=t},handleSave:function(){var t=this;this.$refs["form"].validate((function(e){e&&t.editGoodClassify()}))},editGoodClassify:function(){var t=this;this.loading=!0;var e=Object.assign({id:this.id},this.model);this.$api.goodsApi.editGoodClassify(e).then((function(e){t.loading=!1,0===e.error&&(t.$Message.success("广告设置成功"),t.$router.push({path:"/goods/classify"}))})).catch()},advertisingChange:function(t){this.model.advurl=t.url,this.handleCancel()},openAdvertisingSelector:function(){this.advertising.value=!0},deleteAdLink:function(){this.model.advurl=""},handleCancel:function(){this.advertising.value=!1},getData:function(){var t=this;this.$api.goodsApi.getGoodClassify({id:this.id}).then((function(e){t.model.advurl=e.data.advurl||"",t.model.advimg=e.data.advimg||""})).catch()},resetModel:function(){this.model={advurl:"",advimg:""}}},mounted:function(){var t;this.resetModel(),this.id=(null===(t=this.$route.query)||void 0===t?void 0:t.id)||0,this.id&&this.getData()}};e.default=s},9911:function(t,e,n){"use strict";var i=n("23e7"),a=n("857a"),s=n("af03");i({target:"String",proto:!0,forced:s("link")},{link:function(t){return a(this,"a","href",t)}})},a2d9:function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.staticRenderFns=e.render=void 0;var i=function(){var t=this,e=t._self._c;return e("kdx-content-bar",{scopedSlots:t._u([{key:"btn",fn:function(){return[e("Button",{staticClass:"primary-long",on:{click:t.handleSave}},[t._v("保存")]),e("Button",{staticClass:"default-long",attrs:{to:"/goods/classify"}},[t._v("返回")])]},proxy:!0}])},[e("div",{staticClass:"good-classification-add"},[e("Form",{ref:"form",attrs:{model:t.model,"label-width":120}},[e("kdx-form-title",[t._v("广告设置")]),e("FormItem",{attrs:{label:"分类广告：",prop:"advimg"}},[e("kdx-image-video",{attrs:{type:"ad",current:t.model.advimg},on:{"on-change":t.changeAdvertising}}),e("div",{staticClass:"flex",staticStyle:{"margin-top":"10px"}},[e("kdx-hint-text",{attrs:{content:"推荐分类的广告图，建议尺寸750*250像素，或者比例为3:1的图片。"}}),e("kdx-hint-tooltip",{attrs:{type:"image",image:n("f247")}})],1)],1),e("FormItem",{attrs:{label:"广告链接：",prop:"advurl"}},[e("Button",{directives:[{name:"show",rawName:"v-show",value:!t.model.advurl,expression:"!model.advurl"}],staticClass:"default-primary",on:{click:t.openAdvertisingSelector}},[t._v("+添加")]),e("Button",{directives:[{name:"show",rawName:"v-show",value:t.model.advurl,expression:"model.advurl"}],staticClass:"default-primary",on:{click:t.openAdvertisingSelector}},[t._v("编辑")]),e("div",{staticClass:"ad-link-content"},[e("p",[t._v(t._s(t.model.advurl))]),e("Button",{directives:[{name:"show",rawName:"v-show",value:t.model.advurl,expression:"model.advurl"}],attrs:{type:"text"},on:{click:t.deleteAdLink}},[t._v("删除")])],1)],1)],1),e("Spin",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],attrs:{fix:""}})],1),e("link-selector",{attrs:{current:t.model.advurl},on:{"on-cancel":t.handleCancel,"on-change":t.advertisingChange},model:{value:t.advertising.value,callback:function(e){t.$set(t.advertising,"value",e)},expression:"advertising.value"}})],1)};e.render=i;var a=[];e.staticRenderFns=a},a58b:function(t,e,n){"use strict";n.r(e);var i=n("3107"),a=n("c6ed");for(var s in a)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(s);n("55f7"),n("52a9");var r=n("2877"),l=Object(r["a"])(a["default"],i["render"],i["staticRenderFns"],!1,null,"90370ac6",null);e["default"]=l.exports},ad4e:function(t,e,n){"use strict";n.r(e);var i=n("9688"),a=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(s);e["default"]=a.a},b286:function(t,e,n){"use strict";n.r(e);var i=n("0e507"),a=n("ad4e");for(var s in a)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(s);n("7c61");var r=n("2877"),l=Object(r["a"])(a["default"],i["render"],i["staticRenderFns"],!1,null,"24177219",null);e["default"]=l.exports},c6ed:function(t,e,n){"use strict";n.r(e);var i=n("5511"),a=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(s);e["default"]=a.a},ce9b:function(t,e,n){},f247:function(t,e,n){t.exports=n.p+"static/dist/shop/img/classify_ad.png"}}]);