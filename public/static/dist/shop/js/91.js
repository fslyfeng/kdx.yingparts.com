(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[91],{"045e4":function(e,t,n){"use strict";n.r(t);var a=n("c583"),r=n("e90b");for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("63ba");var o=n("2877"),s=Object(o["a"])(r["default"],a["render"],a["staticRenderFns"],!1,null,"43855d96",null);t["default"]=s.exports},"0476":function(e,t,n){"use strict";n.r(t);var a=n("1707"),r=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a},"0ffc":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.staticRenderFns=t.render=void 0;var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"market-coupons-list"},[t("Table",{ref:"table",attrs:{columns:e.columns,data:e.data},on:{"on-sort-change":e.changeSort},scopedSlots:e._u([{key:"remaining_amount",fn:function(n){var a=n.row;return["0"===a.stock_type?t("div",[e._v("不限制")]):t("div",[e._v(e._s(parseInt(a.stock)-parseInt(a.get_total)))])]}}])}),t("div",{staticClass:"footer-page"},[t("kdx-page-component",{ref:"page",attrs:{total:e.total},on:{"on-change":e.changePage}})],1)],1)};t.render=n;var a=[];t.staticRenderFns=a},"11cf":function(e,t,n){},"12a0":function(e,t,n){"use strict";n.r(t);var a=n("92e1"),r=n("0476");for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("e8bf");var o=n("2877"),s=Object(o["a"])(r["default"],a["render"],a["staticRenderFns"],!1,null,"4b656214",null);t["default"]=s.exports},1707:function(e,t,n){var a=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("ac1f"),n("841c"),n("4e82");var r=a(n("a892")),i=a(n("045e4")),o={name:"index",components:{SearchHeader:r.default,TableList:i.default},inject:["returnToTop"],data:function(){return{search:{},table:{data:[],total:0,loading:!1},page:{pageSize:10,pageNumber:1},sort:{}}},methods:{handleSearch:function(e){this.search=e,this.refreshTable()},handleSort:function(e){this.sort=e,this.refreshTable()},getCouponList:function(){var e=this;this.returnToTop(),this.table.loading=!0;var t=Object.assign({pagesize:this.page.pageSize,page:this.page.pageNumber},this.search,this.sort);this.$api.marketApi.getCouponAllList(t).then((function(t){e.table.loading=!1,0===t.error&&(e.table.data=t.list,e.table.total=t.total)}))},refreshTable:function(){this.page={pageSize:10,pageNumber:1},this.$refs["table"].reset(),this.getCouponList()},changePage:function(e){this.page=e,this.getCouponList()}},mounted:function(){this.refreshTable()}};t.default=o},54959:function(e,t,n){"use strict";n.r(t);var a=n("b233"),r=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a},"626b":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAAeCAYAAAAGos/EAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAA4SURBVHgB3YsxDgAQEMDKIEZ+4MdGMYkf2iUOOa/QsU2RRuBgmWQpJCMVUfOwLDqOyO1qPOPDawNr1jQJbIusxQAAAABJRU5ErkJggg=="},"62e6":function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("a9e3"),n("b680"),n("14d9");var a={name:"TableList",props:{data:{type:Array,default:function(){return[]}},total:{type:Number,default:0}},computed:{noManagePerm:function(){return!this.$getPermMap("sale.coupon-list.manage")}},data:function(){var e=this;this.$createElement;return{columns:[{title:"序号",key:"sort",width:70},{title:"优惠券类型",key:"coupon_sale_type",minWidth:110,maxWidth:120,render:function(e,t){var a;return a="2"===t.row.coupon_sale_type?[e("span","折扣券"),e("img",{attrs:{src:n("e7cd")}})]:[e("span","满减券"),e("img",{attrs:{src:n("626b")}})],e("div",{class:{"coupons-type":!0,deduction:"2"===t.row.coupon_sale_type,"full-reduction":"1"===t.row.coupon_sale_type}},a)}},{title:"优惠券名称",key:"coupon_name",minWidth:100},{title:"优惠内容",key:"content",minWidth:100},{title:"发放总量",key:"stock",minWidth:100,render:function(e,t){return"0"==t.row.stock_type?e("div",["不限制"]):e("div",[t.row[t.column.key]])}},{title:"已领取",key:"get_total",sortable:"custom",minWidth:100},{title:"剩余数量",slot:"remaining_amount",minWidth:100},{title:"使用率",key:"use_num",sortable:"custom",minWidth:100,render:function(e,t){var n=100*parseFloat(t.row[t.column.key]);return e("div",n||0===n?[n.toFixed(2),"%"]:["0.00%"])}},{title:"领取方式",key:"pick_way",minWidth:100,maxWidth:120,render:function(e,t){return e("div",{class:"pickup-method"},[e("span",{class:"free",style:{display:1==t.row.pick_way?"inline-block":"none"}},["免费领取"]),e("span",{class:"pay",style:{display:2==t.row.pick_way?"inline-block":"none"}},["付费领取"]),e("span",{class:"link",style:{display:3==t.row.pick_way?"inline-block":"none"}},["链接领取"]),e("span",{class:"activity",style:{display:4==t.row.pick_way?"inline-block":"none"}},["活动领取"])])}},{title:"创建时间",key:"created_at",width:120,render:function(e,t){return e("p",{style:"word-break: normal"},[t.row[t.column.key]])}},{title:"操作",key:"action",minWidth:80,maxWidth:150,render:function(t,n){var a,r;return"0"===n.row.state?a=t("Button",{attrs:{type:"text",disabled:e.noManagePerm},on:{click:function(){e.setSendState(1,n.row)}}},["开始发放"]):"1"===n.row.state&&(a=t("Button",{attrs:{type:"text",disabled:e.noManagePerm},on:{click:function(){e.setSendState(0,n.row)}}},["停止发放"])),3===n.row.pick_way&&(r=t("kdx-hint-tooltip",{attrs:{type:"qrCode",url:e.$utils.getPreviewUrl("couponLink",n.row.id),text:"复制链接地址"}},[t("Button",{attrs:{type:"text",disabled:e.noManagePerm}},["链接领取"])])),4===n.row.pick_way&&(a=""),t("div",{class:"action"},[a,t("Button",{attrs:{type:"text",disabled:e.noManagePerm},on:{click:function(){e.$router.push({path:"/market/coupons/base/edit",query:{id:n.row.id}})}}},["编辑"]),r])}}]}},methods:{reset:function(){this.$refs["page"].reset()},changePage:function(e){this.$emit("on-page-change",e)},setSendState:function(e,t){var n,a,r=this;e?(n="是否开始发放？",a="开始发放成功"):(n="是否停止发放？",a="停止发放成功");var i={id:t.id,state:e};this.$Modal.confirm({title:"提示",content:n,onOk:function(){r.$api.marketApi.setSendState(i).then((function(e){0===e.error&&(r.$Message.success(a),r.$emit("on-refresh"))}))}})},changeSort:function(e){var t=e.key,n=e.order;"normal"===n?this.$emit("on-sort",{}):this.$emit("on-sort",{sort:t,by:n})},formatData:function(e){return parseInt(e)>999?"999+":e}}};t.default=a},"63ba":function(e,t,n){"use strict";n("11cf")},"73e8":function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.staticRenderFns=t.render=void 0,n("b0c0");var a=function(){var e=this,t=e._self._c;return t("kdx-header-bar",{scopedSlots:e._u([{key:"header",fn:function(){return[t("Button",{attrs:{type:"primary",disabled:e.noManagePerm,to:"/market/coupons/base/add"}},[e._v(" +添加优惠券 ")])]},proxy:!0}])},[t("Form",{ref:"form",attrs:{model:e.model,"label-width":100,inline:""},nativeOn:{submit:function(e){e.preventDefault()}}},[t("FormItem",{attrs:{label:"优惠券名称："}},[t("Input",{staticClass:"width-340",attrs:{type:"text",placeholder:"优惠券名称"},on:{"on-enter":e.handleSearch},model:{value:e.model.keyword,callback:function(t){e.$set(e.model,"keyword",t)},expression:"model.keyword"}})],1),t("FormItem",{attrs:{label:"优惠券类型："}},[t("Select",{staticClass:"width-160",model:{value:e.model.coupon_sale_type,callback:function(t){e.$set(e.model,"coupon_sale_type",t)},expression:"model.coupon_sale_type"}},e._l(e.optionData.coupon_sale_type,(function(n){return t("Option",{key:n.id,attrs:{value:n.id}},[e._v(" "+e._s(n.name)+" ")])})),1)],1),t("FormItem",{attrs:{label:"领取方式："}},[t("Select",{staticClass:"width-160",model:{value:e.model.pick_way,callback:function(t){e.$set(e.model,"pick_way",t)},expression:"model.pick_way"}},e._l(e.optionData.pick_way,(function(n){return t("Option",{key:n.id,attrs:{value:n.id}},[e._v(" "+e._s(n.name)+" ")])})),1)],1),t("FormItem",{attrs:{label:"创建时间："}},[t("DatePicker",{staticClass:"width-340",attrs:{type:"datetimerange",placeholder:"优惠券创建时间"},on:{"on-change":e.changeCreateTime},model:{value:e.createTime,callback:function(t){e.createTime=t},expression:"createTime"}})],1),t("div",{staticClass:"ivu-form-item-btn"},[t("Button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),t("Button",{attrs:{type:"text"},on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1)};t.render=a;var r=[];t.staticRenderFns=r},"92e1":function(e,t,n){"use strict";var a=n("b2fd");n.o(a,"render")&&n.d(t,"render",(function(){return a["render"]})),n.o(a,"staticRenderFns")&&n.d(t,"staticRenderFns",(function(){return a["staticRenderFns"]}))},a892:function(e,t,n){"use strict";n.r(t);var a=n("c3cf"),r=n("54959");for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);var o=n("2877"),s=Object(o["a"])(r["default"],a["render"],a["staticRenderFns"],!1,null,null,null);t["default"]=s.exports},b233:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={name:"SearchHeader",computed:{noManagePerm:function(){return!this.$getPermMap("sale.coupon-list.manage")}},data:function(){return{model:{keyword:"",coupon_sale_type:"",pick_way:"",start_time:"",end_time:""},createTime:[],optionData:{coupon_sale_type:[{id:"all",name:"全部"},{id:1,name:"满减券"},{id:2,name:"折扣券"}],pick_way:[{id:"all",name:"全部"},{id:1,name:"免费领取"},{id:2,name:"付费领取"},{id:3,name:"链接领取"},{id:4,name:"活动领取"}]}}},methods:{handleSearch:function(){var e=Object.assign({},this.model);e.coupon_sale_type="all"===e.coupon_sale_type?"":e.coupon_sale_type,e.pick_way="all"===e.pick_way?"":e.pick_way,this.$emit("on-search",e)},handleReset:function(){this.$emit("on-search",{}),this.resetModel()},resetModel:function(){this.model={keywords:"",coupon_sale_type:"all",pick_way:"all",start_time:"",end_time:""},this.createTime=""},changeCreateTime:function(e){this.model.start_time=e[0],this.model.end_time=e[1]}},mounted:function(){this.resetModel()}};t.default=n},b2fd:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.staticRenderFns=t.render=void 0;var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"market-coupons-all"},[t("search-header",{on:{"on-search":e.handleSearch}}),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.table.loading,expression:"table.loading"}],staticClass:"table-list"},[t("table-list",{ref:"table",attrs:{data:e.table.data,total:e.table.total},on:{"on-page-change":e.changePage,"on-refresh":e.refreshTable,"on-sort":e.handleSort}})],1),e._t("default")],2)};t.render=n;var a=[];t.staticRenderFns=a},c3cf:function(e,t,n){"use strict";var a=n("73e8");n.o(a,"render")&&n.d(t,"render",(function(){return a["render"]})),n.o(a,"staticRenderFns")&&n.d(t,"staticRenderFns",(function(){return a["staticRenderFns"]}))},c583:function(e,t,n){"use strict";var a=n("0ffc");n.o(a,"render")&&n.d(t,"render",(function(){return a["render"]})),n.o(a,"staticRenderFns")&&n.d(t,"staticRenderFns",(function(){return a["staticRenderFns"]}))},e7cd:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAAeBAMAAAD0jNL3AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAPUExURTCI7yyH7y2M7y2N8S2M8GsgvRMAAAAEdFJOUwogoJ8q1PIiAAAAFUlEQVQI12NgYDBkcAFCBQYBBhLZAIgxBI7KasErAAAAAElFTkSuQmCC"},e868:function(e,t,n){},e8bf:function(e,t,n){"use strict";n("e868")},e90b:function(e,t,n){"use strict";n.r(t);var a=n("62e6"),r=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a}}]);