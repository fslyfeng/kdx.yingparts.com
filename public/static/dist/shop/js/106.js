(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[106],{"084a":function(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.staticRenderFns=t.render=void 0,o("b0c0");var i=function(){var e=this,t=e._self._c;return t("kdx-content-bar",{scopedSlots:e._u([{key:"btn",fn:function(){return[t("Button",{staticClass:"handler-btn primary-long",attrs:{disabled:e.noManagePerm},on:{click:e.handleSave}},[e._v("保存")])]},proxy:!0}])},[t("div",{staticClass:"container"},[t("Form",{ref:"form",staticClass:"content",attrs:{model:e.model,rules:e.rules,"label-width":140},on:{"on-validate":e.onValidate}},[t("div",{staticClass:"content-box"},[t("kdx-form-title",[e._v("添加组块信息")]),t("FormItem",{attrs:{label:"商品组块状态：",prop:"mall_status"}},[t("RadioGroup",{model:{value:e.model.status,callback:function(t){e.$set(e.model,"status",t)},expression:"model.status"}},[t("Radio",{attrs:{disabled:e.noManagePerm,label:1}},[t("span",[e._v("开启")])]),t("Radio",{attrs:{disabled:e.noManagePerm,label:0}},[t("span",[e._v("关闭")])])],1),t("kdx-hint-text",[e._v("开启后，PC商城首页显示该商品组模块内容。")])],1),t("FormItem",{directives:[{name:"error-item",rawName:"v-error-item.name",modifiers:{name:!0}}],attrs:{label:"商品组块名称：",prop:"name"}},[t("Input",{staticClass:"width-300",attrs:{disabled:e.noManagePerm,placeholder:"请输入",maxlength:"10","show-word-limit":""},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}}),t("div",{staticClass:"flex"},[t("kdx-hint-text",{attrs:{content:"PC商城 首页展示组块名称。"}}),t("kdx-hint-tooltip",{attrs:{width:"320px",type:"image",image:o("a656")}})],1)],1),t("FormItem",{directives:[{name:"error-item",rawName:"v-error-item.main_img",modifiers:{main_img:!0}}],attrs:{label:"主推图片：",prop:"main_img"}},[t("kdx-image-video",{attrs:{type:"image",current:e.model.main_img},on:{"on-change":function(t){return e.changeThumb(t,"main_img")}}}),t("kdx-hint-text",[e._v("图片为长方形，建议尺寸472*400，用于商城首页分享的系统默认宣传图。")])],1),t("FormItem",{attrs:{label:" 主图图跳转链接：",prop:"main_img_url"}},[t("Input",{staticClass:"width-300",attrs:{placeholder:"请填写跳转pc页面的访问路径"},model:{value:e.model.main_img_url,callback:function(t){e.$set(e.model,"main_img_url",t)},expression:"model.main_img_url"}})],1),t("FormItem",{attrs:{label:"商品选择："}},[t("MyRadioGroup",{attrs:{items:e.goodsList},model:{value:e.model.goods_type,callback:function(t){e.$set(e.model,"goods_type",t)},expression:"model.goods_type"}}),t("div",{staticClass:"width-600"},[t("FormItem",{attrs:{"label-width":0,prop:"goods_info",error:"请选择商品","show-message":e.goods_info_message}},[t(e.goodSelector,{key:e.model.goods_type,tag:"component",attrs:{currentInfo:e.model.goods_info},on:{validateGoodsForm:e.validateGoodsForm,handleChange:e.handleChange}})],1)],1)],1),t("FormItem",{directives:[{name:"error-item",rawName:"v-error-item.name",modifiers:{name:!0}}],attrs:{label:"商品组块排序：",prop:"sort_order"}},[t("Input",{staticClass:"width-300",attrs:{disabled:e.noManagePerm,type:"number",maxlength:"4",placeholder:"请输入"},model:{value:e.model.sort_order,callback:function(t){e.$set(e.model,"sort_order",t)},expression:"model.sort_order"}}),t("div",{staticClass:"flex"},[t("kdx-hint-text",{attrs:{content:"最多4位数字，数字越大，排名越靠前，默认排序为创建时间。"}})],1)],1),t("kdx-form-title",[e._v("广告设置")]),t("FormItem",{attrs:{"label-width":0}},[t("kdx-hint-alert",{attrs:{"show-icon":!1}},[e._v(" 说明：跟随商品组块可添加 广告，在商品组块上下均可添加1条广告图片。 ")])],1),t("FormItem",{attrs:{label:"顶部广告："}},[t("kdx-image-video",{attrs:{height:67,type:"image",current:e.model.top_advertise_img},on:{"on-change":function(t){return e.changeThumb(t,"top_advertise_img")}}}),t("kdx-hint-text",[e._v("最多可添加1张，建议尺寸：1200*120")])],1),t("FormItem",{attrs:{label:" 顶部广告跳转链接："}},[t("Input",{staticClass:"width-300",attrs:{placeholder:"请填写跳转pc页面的访问路径"},model:{value:e.model.top_advertise_img_url,callback:function(t){e.$set(e.model,"top_advertise_img_url",t)},expression:"model.top_advertise_img_url"}})],1),t("FormItem",{attrs:{label:"底部广告：",prop:"login_show_img"}},[t("kdx-image-video",{attrs:{height:67,type:"image",current:e.model.bottom_advertise_img},on:{"on-change":function(t){return e.changeThumb(t,"bottom_advertise_img")}}}),t("kdx-hint-text",[e._v("最多可添加1张，建议尺寸：1200*120")])],1),t("FormItem",{attrs:{label:" 底部广告跳转链接："}},[t("Input",{staticClass:"width-300",attrs:{placeholder:"请填写跳转pc页面的访问路径"},model:{value:e.model.bottom_advertise_img_url,callback:function(t){e.$set(e.model,"bottom_advertise_img_url",t)},expression:"model.bottom_advertise_img_url"}})],1)],1)])],1),e.showUnionSelect?t("div",[t("union-selector",{attrs:{"tab-name":e.chooseTabs,current:e.linkInfo,disabledLink:["wx_service"]},on:{"on-cancel":e.showSelect,"on-change":e.changeLink},model:{value:e.showUnionSelect,callback:function(t){e.showUnionSelect=t},expression:"showUnionSelect"}})],1):e._e()])};t.render=i;var n=[];t.staticRenderFns=n},"09b4":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.staticRenderFns=t.render=void 0;var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"radio-group"},[t("RadioGroup",{attrs:{type:e.type,vertical:e.vertical},on:{"on-change":e.onChange},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},e._l(e.items,(function(o,i){return t("Radio",{key:i,attrs:{label:i,disabled:o.disabled||e.disabled}},[e.$slots.example?e._e():t("span",[e._v(" "+e._s(o.label)+" ")]),e._t("example",null,{example:o})],2)})),1),e.$slots.tip&&e.$slots.tip.length?t("div",{staticClass:"tip"},[e._t("tip")],2):e._e(),e.$slots.default&&e.$slots.default.length?t("div",{staticClass:"content"},[e._t("default")],2):e._e()],1)};t.render=o;var i=[];t.staticRenderFns=i},1987:function(e,t,o){},"1bf7":function(e,t,o){"use strict";var i=o("09b4");o.o(i,"render")&&o.d(t,"render",(function(){return i["render"]})),o.o(i,"staticRenderFns")&&o.d(t,"staticRenderFns",(function(){return i["staticRenderFns"]}))},"42fc":function(e,t,o){},5471:function(e,t,o){"use strict";o.r(t);var i=o("1bf7"),n=o("78d8");for(var a in n)["default"].indexOf(a)<0&&function(e){o.d(t,e,(function(){return n[e]}))}(a);o("af70");var s=o("2877"),r=Object(s["a"])(n["default"],i["render"],i["staticRenderFns"],!1,null,"4f72f8de",null);t["default"]=r.exports},"78d8":function(e,t,o){"use strict";o.r(t);var i=o("bdc7"),n=o.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){o.d(t,e,(function(){return i[e]}))}(a);t["default"]=n.a},"8b72":function(e,t,o){var i=o("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(o("ade3")),a=i(o("5530"));o("d3b7"),o("3ca3"),o("ddb0"),o("d9e2"),o("159b"),o("14d9"),o("d81d");var s=o("2f62"),r=i(o("58bb")),d=i(o("5471")),l=o("d1be"),c={name:"index",components:{UnionSelector:r.default,MyRadioGroup:d.default,GoodSelector1:function(){return o.e(115).then(o.bind(null,"6481"))},GoodSelector2:function(){return o.e(112).then(o.bind(null,"f2ec9"))},GoodSelector3:function(){return o.e(113).then(o.bind(null,"bd35"))}},computed:(0,a.default)((0,a.default)({},(0,s.mapState)("account",{shopId:function(e){return e.shop.shopId}})),{},{noManagePerm:function(){return!this.$getPermMap("pc.goods-group.manage")},isRoot:function(){var e,t;return 1==(null===(e=this.$store.state.config)||void 0===e||null===(t=e.user)||void 0===t?void 0:t.is_root)},goodSelector:function(){return 1==this.model.goods_type||2==this.model.goods_type||3==this.model.goods_type?"GoodSelector"+this.model.goods_type:""},addGoods:function(){var e=this;return!this.goodsList.some((function(t){return e.model.goods_type&&e.model.goods_type==t.id}))}}),data:function(){return{linkFlg:0,showUnionSelect:!1,currentModal:{},goods_info_message:!1,groupId:"",model:{status:1,name:"",main_img:"",main_img_url:"",goods_type:"1",goods_info:[],sort_order:"",top_advertise_img:"",top_advertise_img_url:"",bottom_advertise_img:"",bottom_advertise_img_url:""},rules:{status:[{required:!0,message:"请选择商城状态"}],name:[{required:!0,message:"请输入商品组块名称"}],main_img:[{required:!0,message:"请上传商城主推图",trigger:"change"}],main_img_url:[{required:!0,message:"请输入主推图链接",trigger:"change"}],goods_type:[{required:!0,message:"请选择商品类型",trigger:"change"}],sort_order:[{required:!0,validator:function(e,t,o){t.length>4?o(new Error("最多为4位数")):t?o():o(new Error("请输入商品组排序"))}}]},submitLoading:!1,goodsList:[{label:"自选商品",id:"1"},{label:"商品分类",id:"2"},{label:"商品分组",id:"3"}]}},created:function(){this.getCategory()},methods:{getCategory:function(){var e=this;this.$api.homeApi.goodsGroupTypes().then((function(t){if(0===t.error){var o=[];t.data.forEach((function(e){o.push({label:e.val,id:e.key})})),e.goodsList=(0,l.dealClassifyList)(o)}}))},handleChange:function(e){this.goods_info_message=!1,this.model.goods_info=e,this.$set(this.model,"goods_info",e),console.log("被赋值",this.model.goods_info)},validateGoodsForm:function(){console.log("3456")},getLabelField:function(){var e=this,t={0:{key:"",by:"desc"},1:{key:"sales",by:"desc"},2:{key:"price",by:"desc"},3:{key:"price",by:"asc"}};if(isNaN(1*this.goodsSelectType)){var o={pageCount:1,pagesize:50,status:1,label_field:this.goodsSelectType,sort:t[this.currentModal.params.goodssort].key,by:t[this.currentModal.params.goodssort].by};this.$api.goodsApi.goodsList(o).then((function(t){0===t.error&&(e.currentModal.data=t.list.map((function(e){return{thumb:e.thumb,price:e.price,productprice:e.original_price,sales:e.sales,title:e.title,sub_title:e.sub_title,gid:e.id,bargain:0,credit:0,ctype:0,type:e.type}})),e.refreshCurrentModal())})).catch()}},changeLink:function(e){this.model.mall_close_url=e.url},showSelect:function(){this.showUnionSelect=!this.showUnionSelect},changeThumb:function(e,t){console.log(e,t),this.$set(this.model,t,e)},getData:function(){var e=this;this.$api.homeApi.goodsGroupDetail({id:this.groupId}).then((function(t){0===t.error&&(console.log(t.data.goods_info),t.data.goods_info=JSON.parse(t.data.goods_info),e.model=Object.assign({},t.data),console.log(e.model," this.model"))}))},onValidate:function(e,t){this.cacheError=(0,a.default)((0,a.default)({},this.cacheError),{},(0,n.default)({},e,t))},validate:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return new Promise((function(o){e.$refs["form"].validate((function(i){(Array.isArray(e.model.goods_info)&&e.model.goods_info.length<=0||!Array.isArray(e.model.goods_info)&&!e.model.goods_info.hasOwnProperty("data"))&&(e.goods_info_message=!0),o(i),t(i),e.$nextTick((function(){if(!i)for(var t in e.cacheError)if(!e.cacheError[t]){e.$focusError(t);break}}))}))}))},handleSave:function(){var e=this;console.log(this.model,"model"),this.validate().then((function(t){if(t&&!e.goods_info_message){var o="goodsGroupEdit";""==e.groupId&&(o="goodsGroupAdd"),e.model.id=e.groupId,e.$api.homeApi[o](e.model).then((function(t){0===t.error?(e.$Message.success("保存成功"),setTimeout((function(){e.$router.go(-1)}),1e3)):e.$Message.error(t.message),console.log("保存成功",t)}))}}))}},mounted:function(){this.$route.query.hasOwnProperty("id")&&(this.groupId=this.$route.query.id,this.getData())}};t.default=c},"9b9c":function(e,t,o){"use strict";o.r(t);var i=o("f3b9"),n=o("a4d8");for(var a in n)["default"].indexOf(a)<0&&function(e){o.d(t,e,(function(){return n[e]}))}(a);o("eb757");var s=o("2877"),r=Object(s["a"])(n["default"],i["render"],i["staticRenderFns"],!1,null,"3b40476c",null);t["default"]=r.exports},a4d8:function(e,t,o){"use strict";o.r(t);var i=o("8b72"),n=o.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){o.d(t,e,(function(){return i[e]}))}(a);t["default"]=n.a},a656:function(e,t,o){e.exports=o.p+"static/dist/shop/img/goodsGroupTitle.png"},af70:function(e,t,o){"use strict";o("42fc")},bdc7:function(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,o("a9e3");var i={props:{vertical:{type:Boolean,default:!1},value:{type:[String,Number],default:""},disabled:{type:Boolean,default:!1},lazy:{type:Boolean,default:!1},items:{type:Array,default:function(){return[{label:"label1",iconType:"",disabled:!1},{label:"label2",iconType:"",disabled:!1}]}},type:{type:String,default:void 0}},watch:{value:{immediate:!0,handler:function(){this.selected="-1";for(var e=0;e<this.items.length;e++)this.items[e].id==this.value&&(this.selected=e);if("-1"==this.selected)for(var t=0;t<this.items.length;t++)""===this.items[t].id&&(this.selected=t);this.lastSelected=this.selected}}},data:function(){return{selected:"",lastSelected:null}},methods:{onChange:function(e){var t=this;if(this.lazy)if(null!==this.lastSelected)this.$nextTick((function(){t.selected=t.lastSelected;var o=t.items[e].id;t.$emit("input",o),t.$emit("change",o,t.items[e])}));else{this.lastSelected=this.selected;var o=this.items[this.selected].id;this.$emit("input",o),this.$emit("change",o,this.items[this.selected])}else{var i=this.items[this.selected].id;this.$emit("input",i),this.$emit("change",i,this.items[this.selected])}}}};t.default=i},eb757:function(e,t,o){"use strict";o("1987")},f3b9:function(e,t,o){"use strict";var i=o("084a");o.o(i,"render")&&o.d(t,"render",(function(){return i["render"]})),o.o(i,"staticRenderFns")&&o.d(t,"staticRenderFns",(function(){return i["staticRenderFns"]}))}}]);