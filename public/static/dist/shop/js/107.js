(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[107],{"2d76":function(e,t,i){"use strict";i.r(t);var a=i("6cb3"),n=i.n(a);for(var s in a)["default"].indexOf(s)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(s);t["default"]=n.a},4208:function(e,t,i){"use strict";i.r(t);var a=i("ad29"),n=i("2d76");for(var s in n)["default"].indexOf(s)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(s);i("b49d");var r=i("2877"),c=Object(r["a"])(n["default"],a["render"],a["staticRenderFns"],!1,null,"d1c9896c",null);t["default"]=c.exports},"4ac3":function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.staticRenderFns=t.render=void 0;var a=function(){var e=this;e._self._c;return e._m(0)};t.render=a;var n=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"wechat-empty"},[t("div",{staticClass:"empty-img"},[t("img",{attrs:{src:i("7677"),alt:""}}),t("div",{staticClass:"text"},[e._v(" 您的公众号类型为未认证服务号，暂不支持本功能 ")])])])}];t.staticRenderFns=n},"550d":function(e,t,i){},"6cb3":function(e,t,i){var a=i("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(i("5530")),s=i("3191"),r=a(i("903f")),c={created:function(){var e=this;this.$store.dispatch("channel/getWechatInfo").then((function(t){var i=t.isIdentifyService;e.isIdentifyService=i}))},components:{WechatEmpty:r.default},watch:{"$route.params.type":{immediate:!0,handler:function(e){console.log(e,"val------"),this.auth=e,this.getSyncLibItems()}}},computed:{noManagePerm:function(){return!this.$getPermMap("channel.wechat.manage")}},methods:{del:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$Modal.confirm({title:"提示",content:"确认删除吗?",onOk:function(){e.$api.homeApi.deleteByMediaId({media_id:t}).then((function(t){0==t.error&&(e.$Message.success("删除成功"),e.resetPage())}))}})},getSyncLibItems:function(){var e=this;this.$api.homeApi.getSyncLibItems((0,n.default)({type:this.auth},this.page)).then((function(t){e.total=t.total,e.list=t.list,e.lastSyncTime=t.last_sync_time||"",console.log(t,"@@@====>>>>")}))},changeThumb:function(){},handlePageChange:function(e){this.page.pagesize=e.pageSize,this.page.page=e.pageNumber,this.getSyncLibItems()},resetPage:function(){var e;this.page={pagesize:10,page:1},null===(e=this.$refs["page"])||void 0===e||e.reset(),this.getSyncLibItems()},syncLib:function(){var e=this;this.loadingTable=!0,this.$api.homeApi.syncLib({type:this.auth}).then((function(t){if(0==t.error){var i=function i(){e.$api.homeApi.syncLibStatus({task_id:t.task_id}).then((function(t){var a,n,s,r="";0==(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.status)?r="":1==(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.status)?(r="成功",e.loadingTable=!1):2==(null===t||void 0===t||null===(s=t.data)||void 0===s?void 0:s.status)&&(r="失败",e.loadingTable=!1),""==r?setTimeout((function(){i()}),3e3):(e.resetPage(),e.$Message.success(r))}))};i()}}))},createLib:function(){this.resetPage()}},data:function(){var e=this,t=this.$createElement;return{weixinControl:{isHideMenu:!0,actionApi:{getList:function(){return e.$api.homeApi.getSyncLibItems},uploadFile:function(){return s.homeApi.uploadLib.api},deleteFile:function(){return e.$api.homeApi.deleteByMediaId},getTypeNameByMsgType:function(){return e.auth}}},lastSyncTime:"",dic:{image:"图片",video:"视频",voice:"音频",news:"图文"},isIdentifyService:!1,columns:[{title:"名称",key:"title",render:function(t,i){return t("div",{class:"vp"},[t("video",{attrs:{src:e.$media(i.row.url)}}),i.row.title])}},{title:"状态",key:"status",render:function(){return t("div",["-"])}},{title:"更新时间",key:"created_at"},{title:"操作",render:function(t,i){return t("Button",{class:"del",attrs:{disabled:e.noManagePerm,type:"text"},on:{click:function(){e.del(i.row.media_id)}}},["删除"])}}],data:[],page:{pagesize:10,page:1},total:0,list:[],loading:!1,loadingTable:!1,auth:""}}};t.default=c},7677:function(e,t,i){e.exports=i.p+"static/dist/shop/img/wechat-no-type.png"},"903f":function(e,t,i){"use strict";i.r(t);var a=i("9d65"),n=i("be1b");for(var s in n)["default"].indexOf(s)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(s);i("c76b");var r=i("2877"),c=Object(r["a"])(n["default"],a["render"],a["staticRenderFns"],!1,null,"29b9512d",null);t["default"]=c.exports},"99cf":function(e,t,i){},"9d65":function(e,t,i){"use strict";var a=i("4ac3");i.o(a,"render")&&i.d(t,"render",(function(){return a["render"]})),i.o(a,"staticRenderFns")&&i.d(t,"staticRenderFns",(function(){return a["staticRenderFns"]}))},ad29:function(e,t,i){"use strict";var a=i("bf9c");i.o(a,"render")&&i.d(t,"render",(function(){return a["render"]})),i.o(a,"staticRenderFns")&&i.d(t,"staticRenderFns",(function(){return a["staticRenderFns"]}))},b49d:function(e,t,i){"use strict";i("550d")},be1b:function(e,t,i){"use strict";i.r(t);var a=i("c3d3"),n=i.n(a);for(var s in a)["default"].indexOf(s)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(s);t["default"]=n.a},bf9c:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.staticRenderFns=t.render=void 0,i("caad");var a=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"fans-label"},[t("kdx-header-bar",{attrs:{type:"little"},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"header-btn"},["news"!=e.auth?t("kdx-image-video",{key:Math.random(),staticClass:"marginL-10 blk",staticStyle:{"margin-right":"20px"},attrs:{weixinControl:e.weixinControl,desc:"添加微信".concat(e.dic[e.auth],"素材"),videoName:"添加微信".concat(e.dic[e.auth],"素材"),type:e.auth,isReadonly:e.noManagePerm},on:{"on-change":e.createLib,"on-video-change":e.createLib}}):e._e(),t("Button",{staticClass:"btn",attrs:{disabled:e.noManagePerm},on:{click:e.syncLib}},[e._v("同步微信"+e._s(e.dic[e.auth])+"素材")])],1)]},proxy:!0}])}),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingTable,expression:"loadingTable"}],staticClass:"table-list"},[t("div",{staticClass:"sync-time"},[e._v(" 上次同步时间："),t("span",{staticClass:"time"},[e._v(e._s(e.lastSyncTime||"00-00-00 00:00:00"))])]),t("div",{staticClass:"image-selector-modal"},[t("div",{staticClass:"image-selector-local"},[t("div",{staticClass:"image-content"},[t("div",{ref:"scrollBox",staticClass:"image-list"},["video"!=e.auth&&"news"!=e.auth?t("ul",e._l(e.list,(function(i){return t("li",{key:i.media_id},[["image","voice"].includes(i.type)?t("div",{staticClass:"image"},["image"==i.type?t("img",{attrs:{src:e.$utils.getWechatImg(i.url),alt:""},on:{error:e.replaceImage}}):"voice"==i.type?t("audio",{attrs:{src:e.$media(i.url)}}):e._e(),"voice"==i.type?t("div",{staticClass:"awp"},[e._v(" "+e._s(i.title)+" ")]):e._e(),t("div",{staticClass:"layer"},[e.noManagePerm?e._e():t("Icon",{staticClass:"close",attrs:{type:"ios-close-circle"},on:{click:function(t){return e.del(i.media_id)}}}),t("div",{staticClass:"image-size"},[e._v(" "+e._s(i.created_at)+" ")])],1)]):e._e()])})),0):e._e(),"news"==e.auth?t("div",{staticClass:"msg_sender",staticStyle:{"margin-bottom":"10px"}},[t("div",{staticClass:"ct"},e._l(e.list,(function(i){return t("div",{key:i.media_id,staticClass:"img_msg_wrap"},[t("div",{staticClass:"date"},[e._v("更新于 "+e._s(i.created_at))]),e._l(i.news_item,(function(i,a){return t("div",{key:i.id,staticClass:"lq",class:{im:a>0}},[t("div",{staticStyle:{width:"215px",overflow:"hidden"}},[t("img",{staticClass:"img",attrs:{src:e.$utils.getWechatImg(i.thumb_url)},on:{error:e.replaceImage}})]),t("div",{staticClass:"sub_title"},[e._v(" "+e._s(i.title||"-")+" ")])])})),t("div",{staticClass:"layer"},[t("Icon",{staticClass:"close",attrs:{type:"ios-close-circle"},on:{click:function(t){return e.del(i.media_id)}}})],1)],2)})),0)]):e._e(),"video"==e.auth?t("div",{staticStyle:{"margin-bottom":"10px"}},[t("Table",{attrs:{columns:e.columns,data:e.list}})],1):e._e()])])])]),"video"!=e.auth?t("div",{staticStyle:{"border-top":"1px solid #e9edef"}}):e._e(),t("kdx-page-component",{ref:"page",staticStyle:{"text-align":"center","margin-top":"20px"},attrs:{total:e.total,pageSize:e.page.pagesize},on:{"on-change":e.handlePageChange}})],1),e.isIdentifyService?e._e():t("wechat-empty")],1)};t.render=a;var n=[];t.staticRenderFns=n},c3d3:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"WechatEmpty"};t.default=i},c76b:function(e,t,i){"use strict";i("99cf")}}]);