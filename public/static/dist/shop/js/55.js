(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[55],{"03ca6":function(t,e,i){},"0733":function(t,e,i){"use strict";i.r(e);var a=i("3c5a"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},"0bcf":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.staticRenderFns=e.render=void 0,i("a9e3");var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"preview-index"},[e("div",{staticClass:"preview-title"},[t._v("拼团预览")]),e("div",{staticClass:"preview-box"},[e("div",{staticClass:"img"},[e("img",{attrs:{src:i("3084"),alt:""}})]),e("div",{staticClass:"img"},[e("img",{attrs:{src:i("bb47"),alt:""}})]),e("div",{staticClass:"goods-img"},[e("img",{attrs:{src:t.$utils.media(t.data.goods_info.thumb),alt:""},on:{error:t.replaceImage}})]),e("div",{staticClass:"detail-activity"},[e("div",{staticClass:"activity-detail-content"},[e("div",{staticClass:"left"},[e("div",{staticClass:"price"},[e("span",{staticClass:"unit"},[t._v("￥")]),e("span",{staticClass:"price-num"},[t._v(t._s(Number(t.data.goods_info.activity_price)||20))])]),e("div",{staticClass:"group-price"},[e("div",{staticClass:"group-num"},[0==t.data.group_type?[t._v(" "+t._s(t.data.group_num)+"人拼团价 ")]:[t._v(" 人多更优惠 ")]],2),e("div",{staticClass:"del-price"},[t._v(" ￥"+t._s(t.data.goods_info.original_price||100)+" ")])]),e("span",{staticClass:"iconfont icon-pintuan2-1"})]),t._m(0)])]),e("div",{staticClass:"detail_info"},[e("div",{staticClass:"container"},[e("div",{staticClass:"title-floor floor flex"},[e("p",{staticClass:"title"},[t._v(t._s(t.data.goods_info.title))]),"1"==t.data.is_commission?e("div",{staticClass:"share-commission"},[t._m(1)]):t._e()]),t.data.goods_info.sub_title?e("div",{staticClass:"desc-floor floor"},[t._v(" "+t._s(t.data.goods_info.sub_title)+" ")]):t._e()])]),e("div",{staticClass:"detail_navbar van-hairline--top"},[t._m(2),t._m(3),e("div",{staticClass:"navbar-btn"},[1==t.data.rules.single_buy?e("div",{staticClass:"left-btn"},[e("div",{staticClass:"left-btn-desc"},[t._v("¥"+t._s(t.data.goods_info.price||999))]),e("div",{staticClass:"left-btn-label"},[t._v("单独购买")])]):t._e(),e("div",{staticClass:"right-btn"},[e("div",{staticClass:"left-btn-desc"},[t._v("¥"+t._s(t.data.goods_info.activity_price||999))]),e("span",{staticClass:"right-btn-text"},[t._v("我要开团")])])])])])])};e.render=a;var s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"right"},[e("div",{staticClass:"seckill-surplus"},[t._v("活动剩余时间")]),e("div",{staticClass:"seckill-count"},[e("span",{staticClass:"text orange"},[t._v("2天")]),e("span",{staticClass:"time"},[t._v("23")]),e("span",{staticClass:"colon orange"},[t._v(":")]),e("span",{staticClass:"time"},[t._v("23")]),e("span",{staticClass:"colon orange"},[t._v(":")]),e("span",{staticClass:"time"},[t._v("23")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"commission"},[e("p",{staticClass:"word"},[t._v("预计返利")]),e("p",{staticClass:"money"},[e("span",{staticClass:"money-unit"},[t._v("￥")]),e("span",{staticClass:"num"},[t._v("5")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"btn-shop"},[e("span",{staticClass:"iconfont-m- icon-m-iconfontshop"}),e("span",{staticClass:"text"},[t._v("店铺")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"btn-shop"},[e("span",{staticClass:"iconfont-m- icon-m-xingxingkongxin"}),e("span",{staticClass:"text"},[t._v("收藏")])])}];e.staticRenderFns=s},"15c2":function(t,e,i){},1631:function(t,e,i){"use strict";i("7cf3")},"1b58":function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("d9e2"),i("a9e3"),i("d3b7"),i("fb6a"),i("d81d");var s=a(i("3d60")),o={name:"RulesGoods",components:{specificationsRules:s.default},props:{value:{type:Array,default:function(){return[]}},type:{type:String,default:""},isDisabled:{type:Boolean,default:!1}},data:function(){var t=this,e=this.$createElement;return{page:{pageSize:10,pageNumber:1},total:0,specificationsData:{rulesModal:!1,goodsId:"",spaceRules:[]},form:{goodsList:[]},columns:[{title:"商品",slot:"shop",minWidth:220},{title:"售卖价",slot:"price",minWidth:130},{title:"现库存",slot:"stock",minWidth:80},{slot:"rules",minWidth:450,renderHeader:function(){return e("div",{class:"flex"},[e("p",{class:"table-title"},["拼团库存"]),e("p",{class:"table-title"},["拼团价格"]),e("p",{class:"table-title"},["团长价(非必填)"])])}},{title:"操作",key:"action",width:80,render:function(e,i){return e("Button",{attrs:{type:"text",disabled:t.isDisabled},class:"action-btn",on:{click:function(){t.handleDelete(i.index)}}},["删除"])}}],rules:{activity_stock:[{validator:function(e,i,a){var s=e.field.split(".")[1];i?0===Number(i)?a(new Error("拼团库存不能为0")):Number(t.form.goodsList[s].stock)<Number(i)?a(new Error("拼团库存大于现库存")):a():a(new Error("拼团库存不能为空"))}}],activity_price:[{validator:function(e,i,a){var s=e.field.split(".")[1];i?Number(t.form.goodsList[s].price)<=Number(i)?a(new Error("拼团价格需小于售卖价")):a():a(new Error("拼团价格不能为空"))}}],leader_price:[{validator:function(e,i,a){var s,o,n=e.field.split(".")[1],r=null===(s=t.form.goodsList[n])||void 0===s?void 0:s.price,l=(null===(o=t.form.goodsList[n])||void 0===o?void 0:o.activity_price)||r;i&&(Number(r)<=Number(i)?a(new Error("团长价格需小于售售卖价")):Number(l)<=Number(i)&&a(new Error("团长价格需小于拼团价格"))),a()}}]}}},watch:{value:{handler:function(){var t=this;this.$nextTick((function(){t.reset()}))},immediate:!0}},created:function(){},mounted:function(){},methods:{validateForm:function(){var t=this;return new Promise((function(e,i){t.form.goodsList.some((function(t){return 1!=t.has_option}))?t.$refs["goodsForm"].validate((function(t){t?e():i()})):(t.form.goodsList.some((function(t){return!t.rules}))&&(t.$Message.error("每个商品必须有一个规格参加活动"),i()),e())}))},reset:function(){var t;null===(t=this.$refs["page"])||void 0===t||t.reset(),this.page={pageSize:10,pageNumber:1},this.getPageData()},getPageData:function(){this.total=this.value.length;var t=this.page.pageSize*(this.page.pageNumber-1),e=this.page.pageSize*this.page.pageNumber;this.form.goodsList=this.value.slice(t,e)},changePage:function(t){this.page=t,this.getPageData()},handleDelete:function(t){var e=(this.page.pageNumber-1)*this.page.pageSize+t;this.$emit("delete",e)},handleSelectOption:function(t){var e=this;this.specificationsData.rulesModal=!0,this.specificationsData.goodsId=t,this.form.goodsList.map((function(i){var a;i.id==t&&(null===i||void 0===i||null===(a=i.rules)||void 0===a?void 0:a.length)>0&&(e.specificationsData.spaceRules=i.rules)}))},handleSpaceGoods:function(t){var e=this.value.map((function(e){return e.id==t.id&&(e.goods_id=e.id,e.rules=t.rules),e}));this.$emit("input",e)},isSetRules:function(t){var e,i;return(null===(e=t.rules)||void 0===e?void 0:e.length)>0&&(null===(i=t.rules)||void 0===i?void 0:i.some((function(t){return"1"==t.is_join})))},goodsType:function(t){var e={goodsName:"",goodsText:""};switch(t){case"0":e={goodsName:"real",goodsText:"实"};break;case"1":e={goodsName:"virtual",goodsText:"虚"};break;case"2":e={goodsName:"secret",goodsText:"密"};break;case"3":e={goodsName:"appoint",goodsText:"预"};break;case"5":e={goodsName:"verifyCount",goodsText:"次"};break;case"6":e={goodsName:"netRecharge",goodsText:"充"};break;case"7":e={goodsName:"medicine",goodsText:"药"};break;default:e={goodsName:"",goodsText:""};break}return e}}};e.default=o},"1da0":function(t,e,i){"use strict";var a=i("bc66");i.o(a,"render")&&i.d(e,"render",(function(){return a["render"]})),i.o(a,"staticRenderFns")&&i.d(e,"staticRenderFns",(function(){return a["staticRenderFns"]}))},"1f116":function(t,e,i){"use strict";i.r(e);var a=i("f031"),s=i("a02b");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("1631");var n=i("2877"),r=Object(n["a"])(s["default"],a["render"],a["staticRenderFns"],!1,null,"1dc6293e",null);e["default"]=r.exports},"221d":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.staticRenderFns=e.render=void 0,i("99af");var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"rules-goods-table"},[e("Form",{ref:"goodsForm",attrs:{model:t.form,rules:t.rules}},[e("Table",{attrs:{columns:t.columns,data:t.form.goodsList},scopedSlots:t._u([{key:"shop",fn:function(i){var a=i.row;return[e("div",{staticClass:"shop-box"},[e("div",{staticClass:"image"},[e("img",{attrs:{src:t.$media(a.thumb)},on:{error:t.replaceImage}})]),e("div",{staticClass:"title-content"},[e("div",{staticClass:"content-text"},[e("span",{staticClass:"mark",style:1==a.has_option?"display:inline-block":"display:none"},[t._v("多")]),e("span",{staticClass:"mark",class:t.goodsType(a.type).goodsName},[t._v(t._s(t.goodsType(a.type).goodsText))]),e("span",{staticClass:"text"},[t._v(t._s(a.title))])])])])]}},{key:"price",fn:function(i){var a=i.row;return[e("div",{staticClass:"price"},[1==a.has_option?e("div",{staticClass:"flex-wrap"},[e("div",[t._v("￥"+t._s(a.min_price))]),e("div",[t._v("~")]),e("div",[t._v("￥"+t._s(a.max_price))])]):e("span",[t._v("￥"+t._s(a.price))])])]}},{key:"stock",fn:function(i){var a=i.row;return[e("div",[t._v(t._s(parseInt(a.stock)>999?"999+":parseInt(a.stock)))])]}},{key:"rules",fn:function(i){var a=i.row,s=i.index;return[1==a.has_option?e("div",{staticClass:"deposit-btn"},[t.isSetRules(a)?e("Button",{staticClass:"default-primary on-set",on:{click:function(e){return t.handleSelectOption(a.id)}}},[t._v("已设置（可点击修改） ")]):e("Button",{staticClass:"default-primary off-set",on:{click:function(e){return t.handleSelectOption(a.id)}}},[t._v("未设置拼团库存及价格 ")])],1):e("div",{staticClass:"flex"},[e("div",{staticClass:"table-input"},[e("FormItem",{attrs:{prop:"goodsList.".concat(s,".activity_stock"),rules:t.rules.activity_stock}},[e("kdx-rr-input",{attrs:{type:"text",number:"",fixed:0,maxValue:999999999,disabled:t.isDisabled},model:{value:t.form.goodsList[s].activity_stock,callback:function(e){t.$set(t.form.goodsList[s],"activity_stock",e)},expression:"form.goodsList[index].activity_stock"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])])],1)],1),t.ladderNum.length?t._l(t.ladderNum,(function(i,a){return e("div",{key:a,staticClass:"table-input"},[e("FormItem",{attrs:{prop:"goodsList.".concat(s,".activity_price").concat(a+1),rules:t.rules["activity_price".concat(a+1)]}},[e("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[s]["activity_price".concat(a+1)],callback:function(e){t.$set(t.form.goodsList[s],"activity_price".concat(a+1),e)},expression:"form.goodsList[index][`activity_price${i+1}`]"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)],1)})):t._e(),e("div",{staticClass:"table-input"},[e("FormItem",{attrs:{prop:"goodsList.".concat(s,".leader_price"),rules:t.rules.leader_price}},[e("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[s].leader_price,callback:function(e){t.$set(t.form.goodsList[s],"leader_price",e)},expression:"form.goodsList[index].leader_price"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)],1)],2)]}}])})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.form.goodsList&&t.form.goodsList.length>0,expression:"form.goodsList && form.goodsList.length > 0"}],staticClass:"footer-page"},[e("page-component",{ref:"page",attrs:{total:t.total},on:{"on-change":t.changePage}})],1),e("ladder-specifications-rules",{attrs:{goodsId:t.specificationsData.goodsId,type:t.type,"is-disabled":t.isDisabled,"ladder-num":t.ladderNum,spaceRules:t.specificationsData.spaceRules},on:{spaceGoods:t.handleSpaceGoods},model:{value:t.specificationsData.rulesModal,callback:function(e){t.$set(t.specificationsData,"rulesModal",e)},expression:"specificationsData.rulesModal"}})],1)};e.render=a;var s=[];e.staticRenderFns=s},"25b0":function(t,e,i){"use strict";i("577b")},"2d67":function(t,e,i){"use strict";i("15c2")},"30d5":function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(i("2909"));i("d9e2"),i("a9e3"),i("fb6a"),i("d81d"),i("99af"),i("d3b7"),i("a434");var o=a(i("d050")),n={name:"RulesGoods",components:{LadderSpecificationsRules:o.default},props:{value:{type:Array,default:function(){return[]}},type:{type:String,default:""},isDisabled:{type:Boolean,default:!1},ladderNum:{type:Array,default:function(){return[]}}},data:function(){var t=this;this.$createElement;return{page:{pageSize:10,pageNumber:1},specificationsData:{rulesModal:!1,goodsId:"",spaceRules:[]},form:{goodsList:[]},columns:[],defaultColumns:[{title:"商品",slot:"shop",minWidth:220},{title:"售卖价",slot:"price",minWidth:130},{title:"现库存",slot:"stock",minWidth:80}],actionColumns:{title:"操作",key:"action",width:80,render:function(e,i){return e("Button",{attrs:{type:"text",disabled:t.isDisabled},class:"action-btn",on:{click:function(){t.handleDelete(i.index)}}},["删除"])}},rules:{activity_stock:[{validator:function(e,i,a){var s=e.field.split(".")[1];i?0===Number(i)?a(new Error("拼团库存不能为0")):Number(t.form.goodsList[s].stock)<Number(i)?a(new Error("拼团库存大于现库存")):a():a(new Error("拼团库存不能为空"))}}],activity_price:[{validator:function(e,i,a){var s=e.field.split(".")[1];i?Number(t.form.goodsList[s].price)<=Number(i)?a(new Error("拼团价格需小于售卖价")):a():a(new Error("拼团价格不能为空"))}}],activity_price1:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=t.form.goodsList[s],n=parseFloat(o.price);i?(i=parseFloat(i),n<=i&&a(new Error("拼团价格需小于售卖价"))):a(new Error("拼团价格不能为空")),a()}}],activity_price2:[{validator:function(e,i,a){console.log("rule------");var s=e.field.split(".")[1],o=e.field.slice(-1)-1,n=t.form.goodsList[s],r=parseFloat(n.price);if(console.log("value",i),i){i=parseFloat(i),r<=i&&a(new Error("拼团价格需小于售卖价"));var l=n["activity_price".concat(o)];l&&parseFloat(l)<=i&&a(new Error("阶梯拼团价要比上一阶梯小")),a()}else a(new Error("拼团价格不能为空"))}}],activity_price3:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=e.field.slice(-1)-1,n=t.form.goodsList[s],r=parseFloat(n.price);if(i){i=parseFloat(i),r<=i&&a(new Error("拼团价格需小于售卖价"));var l=n["activity_price".concat(o)];l&&parseFloat(l)<=i&&a(new Error("阶梯拼团价要比上一阶梯小")),a()}else a(new Error("拼团价格不能为空"))}}],leader_price:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=t.form.goodsList[s],n=null===o||void 0===o?void 0:o.price,r=null===o||void 0===o?void 0:o["activity_price".concat(t.ladderNum.length)];i&&(Number(n)<=Number(i)?a(new Error("团长价格需小于售售卖价")):Number(r)<=Number(i)&&a(new Error("团长价格需小于拼团价格"))),a()}}]}}},computed:{total:function(){var t;return(null===(t=this.form.goodsList)||void 0===t?void 0:t.length)||0}},watch:{value:{handler:function(t){this.form.goodsList=t},immediate:!0},ladderNum:{handler:function(){this.setColumns()},immediate:!0,deep:!0}},created:function(){},mounted:function(){},methods:{setColumns:function(){var t=this,e=this.$createElement,i=300+150*this.ladderNum.length,a={slot:"rules",minWidth:i,renderHeader:function(){return e("div",{class:"flex"},[e("p",{class:"table-title"},["拼团库存"]),t.ladderNum.map((function(t){return e("p",{class:"table-title"},[t.num,"人拼团价"])})),e("p",{class:"table-title"},["团长价(非必填)"])])}};this.columns=[].concat((0,s.default)(this.defaultColumns),[a,this.actionColumns])},validateForm:function(){var t=this;return new Promise((function(e,i){t.form.goodsList.some((function(t){return 1!=t.has_option}))?t.$refs["goodsForm"].validate((function(t){t?e():i()})):(t.form.goodsList.some((function(t){return!t.rules}))&&(t.$Message.error("每个商品必须有一个规格参加活动"),i()),e())}))},changePage:function(t){this.page=t},handleDelete:function(t){this.form.goodsList.splice(t,1),this.$emit("input",this.form.goodsList)},handleSelectOption:function(t){var e=this;this.specificationsData.rulesModal=!0,this.specificationsData.goodsId=t,this.form.goodsList.map((function(i){var a;i.id==t&&(null===i||void 0===i||null===(a=i.rules)||void 0===a?void 0:a.length)>0&&(e.specificationsData.spaceRules=i.rules)}))},handleSpaceGoods:function(t){this.form.goodsList=this.form.goodsList.map((function(e){return e.id==t.id&&(e.goods_id=e.id,e.rules=t.rules),e})),this.$emit("input",this.form.goodsList)},isSetRules:function(t){var e,i;return(null===(e=t.rules)||void 0===e?void 0:e.length)>0&&(null===(i=t.rules)||void 0===i?void 0:i.some((function(t){return"1"==t.is_join})))},goodsType:function(t){var e={goodsName:"",goodsText:""};switch(t){case"0":e={goodsName:"real",goodsText:"实"};break;case"1":e={goodsName:"virtual",goodsText:"虚"};break;case"2":e={goodsName:"secret",goodsText:"密"};break;case"3":e={goodsName:"appoint",goodsText:"预"};break;case"5":e={goodsName:"verifyCount",goodsText:"次"};break;case"6":e={goodsName:"netRecharge",goodsText:"充"};break;case"7":e={goodsName:"medicine",goodsText:"药"};break;default:e={goodsName:"",goodsText:""};break}return e}}};e.default=n},3210:function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("4de4"),i("d3b7"),i("159b");var s=a(i("5530")),o={name:"Preview",components:{},props:{activityData:{type:Object,default:function(){}}},data:function(){return{data:{}}},watch:{activityData:{handler:function(t){var e;if(null!==t&&void 0!==t&&null!==(e=t.goods_info)&&void 0!==e&&e.length){var i,a,o,n=(0,s.default)({},null===t||void 0===t?void 0:t.goods_info[0]);if(1==n.has_option){var r,l,d,c,u,p=null===(r=n)||void 0===r||null===(l=r.rules)||void 0===l?void 0:l.filter((function(t){return 1==t.is_join}))[0],f=null===p||void 0===p?void 0:p.activity_stock,m=null===p||void 0===p?void 0:p.activity_price;if(1==t.inner_type)m=null===p||void 0===p||null===(u=p.ladder_price)||void 0===u?void 0:u[t.group_num_list.length];var v=null===(d=n)||void 0===d||null===(c=d.rules)||void 0===c?void 0:c.filter((function(t){return 1==t.is_join}));v&&v.length&&(f=0,v.forEach((function(t){f+=parseInt(t.activity_stock)}))),n=(0,s.default)((0,s.default)({},n),{},{activity_price:m||10,activity_stock:f||100})}if(1==t.inner_type)if(1==n.has_option)n.activity_price=(null===(a=n.rules)||void 0===a||null===(o=a[0])||void 0===o?void 0:o.ladder_price[t.group_num_list.length])||"2000",n.original_price=n.min_price,n.price=n.min_price;else n.activity_price=n["activity_price".concat(t.group_num_list.length)];var _=(null===t||void 0===t||null===(i=t.rules)||void 0===i?void 0:i.single_buy)||1;this.data=(0,s.default)((0,s.default)({},t),{},{single_buy:_,goods_info:n})}else this.data=(0,s.default)((0,s.default)({},t),{},{goods_info:{thumb:this.$utils.staticImg("decorate/default_goods3.jpg"),price:"334.00",title:"衬衫男女长袖夏季日系ins风文艺薄款亚麻港风男士女士小清新棉麻条纹白衬女士",has_option:0,activity_price:10,activity_stock:100,stock:100,sales:45,group_num:2,min_price:"334.00",single_buy:1,sub_title:"条纹棉麻衬衫，慵随性饭，自然、舒适、透气、吸湿散湿快，可单穿当外套搭配T恤都很好看，整个风格"}})},deep:!0,immediate:!0}},computed:{},created:function(){},mounted:function(){},methods:{}};e.default=o},"32a3":function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.staticRenderFns=e.render=void 0;var i=function(){var t=this,e=t._self._c;return e("kdx-modal-frame",{attrs:{title:"设置拼团商品信息",value:t.modal,width:"1020","mask-closable":!1,loading:t.loading,footerHide:t.isDisabled},on:{"on-cancel":t.handleCancel,"on-ok":t.handleOK}},[e("div",{staticClass:"multi-specification"},[e("div",{staticClass:"setting flex"},[e("span",[t._v("批量设置：")]),e("div",{staticClass:"setting-input flex"},[e("Checkbox",{attrs:{"true-value":"1","false-value":"0",disabled:t.isDisabled},on:{"on-change":t.changeSeckill},model:{value:t.allSeckill,callback:function(e){t.allSeckill=e},expression:"allSeckill"}},[t._v("参与拼团 ")]),e("kdx-rr-input",{attrs:{type:"text",placeholder:"拼团库存",number:"",fixed:0,disabled:t.isDisabled,maxValue:999999999},model:{value:t.batchData.activity_stock,callback:function(e){t.$set(t.batchData,"activity_stock",e)},expression:"batchData.activity_stock"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])]),e("kdx-rr-input",{attrs:{type:"text",placeholder:"拼团价格",number:"",fixed:2,disabled:t.isDisabled,maxValue:9999999.99},model:{value:t.batchData.activity_price,callback:function(e){t.$set(t.batchData,"activity_price",e)},expression:"batchData.activity_price"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])]),e("kdx-rr-input",{attrs:{type:"text",placeholder:"团长价(非必填)",number:"",fixed:2,disabled:t.isDisabled,maxValue:9999999.99},model:{value:t.batchData.leader_price,callback:function(e){t.$set(t.batchData,"leader_price",e)},expression:"batchData.leader_price"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])]),e("Button",{staticClass:"default-primary",attrs:{disabled:t.isDisabled},on:{click:t.handleBatchChange}},[t._v("应用")])],1)]),e("div",{staticClass:"table-list"},[e("Form",{ref:"goodsForm",attrs:{model:t.form,rules:t.rules}},[e("Table",{ref:"table",attrs:{columns:t.columns,data:t.form.goodsList,"span-method":t.handleSpan},scopedSlots:t._u([{key:"is_join",fn:function(i){var a=i.index;return[e("FormItem",{attrs:{prop:"goodsList.".concat(a,".is_join"),rules:t.rules.is_join}},[e("Checkbox",{attrs:{"true-value":"1","false-value":"0",disabled:t.isDisabled},model:{value:t.form.goodsList[a].is_join,callback:function(e){t.$set(t.form.goodsList[a],"is_join",e)},expression:"form.goodsList[index].is_join"}},[t._v("参与 ")])],1)]}},{key:"activity_stock",fn:function(i){var a=i.index;return[e("FormItem",{attrs:{prop:"goodsList.".concat(a,".activity_stock"),rules:t.rules.activity_stock}},[e("kdx-rr-input",{attrs:{type:"text",number:"",fixed:0,maxValue:999999999,disabled:t.isDisabled},model:{value:t.form.goodsList[a].activity_stock,callback:function(e){t.$set(t.form.goodsList[a],"activity_stock",e)},expression:"form.goodsList[index].activity_stock"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])])],1)]}},{key:"activity_price",fn:function(i){var a=i.index;return[e("FormItem",{attrs:{prop:"goodsList.".concat(a,".activity_price"),rules:t.rules.activity_price}},[e("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[a].activity_price,callback:function(e){t.$set(t.form.goodsList[a],"activity_price",e)},expression:"form.goodsList[index].activity_price"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)]}},{key:"leader_price",fn:function(i){var a=i.index;return[e("FormItem",{attrs:{prop:"goodsList.".concat(a,".leader_price"),rules:t.rules.leader_price}},[e("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[a].leader_price,callback:function(e){t.$set(t.form.goodsList[a],"leader_price",e)},expression:"form.goodsList[index].leader_price"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)]}}])})],1)],1)])])};e.render=i;var a=[];e.staticRenderFns=a},"37e3":function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.staticRenderFns=e.render=void 0;var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"groups-rules-info"},[e("Form",{ref:"rules_form",attrs:{model:t.model,"label-width":120,rules:t.rule}},[e("kdx-form-title",[t._v("规则设置")]),"1"==t.model.inner_type?e("FormItem",{attrs:{label:"成团人数："}},[e("ladder-group-num",{ref:"ladder_group_num",attrs:{data:t.model.group_num_list,"is-disabled":t.isDisabled},on:{"update:data":function(e){return t.$set(t.model,"group_num_list",e)}}})],1):t._e(),e("FormItem",{ref:"goods_info",attrs:{label:"拼团商品：",prop:"goods_info"}},[e("div",{staticClass:"next-box"},[e("Button",{staticClass:"default-primary",attrs:{disabled:t.isDisabled},on:{click:t.addGoods}},[t._v("选择拼团商品")]),e("kdx-hint-text",[t._v("提示：拼团库存不得大于商品库存，用户付款成功即扣除库存；拼团不支持会员折扣")]),t.model.goods_info&&t.model.goods_info.length>0?e("div",{staticClass:"goods-box"},["1"==t.model.inner_type?e("ladder-rules-goods",{ref:"goods_ladder_goods",attrs:{"is-disabled":t.isDisabled,type:t.type,"ladder-num":t.model.group_num_list},model:{value:t.model.goods_info,callback:function(e){t.$set(t.model,"goods_info",e)},expression:"model.goods_info"}}):e("rules-goods",{ref:"goods_rule",attrs:{"is-disabled":t.isDisabled,type:t.type},on:{delete:t.handleDelete},model:{value:t.model.goods_info,callback:function(e){t.$set(t.model,"goods_info",e)},expression:"model.goods_info"}})],1):t._e()],1)]),e("div",{staticClass:"validity"},[e("div",{staticClass:"flex"},[e("FormItem",{attrs:{label:"拼团有效期：",prop:"hour"}},[e("kdx-rr-input",{staticClass:"width-100",attrs:{placeholder:"请输入",number:"","min-value":0,maxValue:999999999,fixed:0,disabled:t.isDisabled},model:{value:t.model.hour,callback:function(e){t.$set(t.model,"hour",e)},expression:"model.hour"}}),e("span",{staticClass:"form-item-explain"},[t._v("时")])],1),e("FormItem",{attrs:{prop:"minute","label-width":0}},[e("kdx-rr-input",{staticClass:"width-100",attrs:{placeholder:"请输入",number:"","min-value":0,fixed:0,"max-value":59,disabled:t.isDisabled},model:{value:t.model.minute,callback:function(e){t.$set(t.model,"minute",e)},expression:"model.minute"}}),e("span",{staticClass:"form-item-explain"},[t._v("分")])],1)],1),e("kdx-hint-text",[t._v("用户需在有效期内成团，超时则拼团失败")])],1),"0"==t.model.inner_type?e("FormItem",{attrs:{label:"成团人数：",prop:"rules.success_num"}},[e("kdx-rr-input",{staticClass:"width-160",attrs:{placeholder:"请输入2-100",number:"",fixed:0,"min-value":2,"max-value":100,disabled:t.isDisabled},model:{value:t.model.rules.success_num,callback:function(e){t.$set(t.model.rules,"success_num",e)},expression:"model.rules.success_num"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("人")])])],1):t._e(),e("FormItem",{attrs:{label:"模拟成团："}},[e("RadioGroup",{model:{value:t.model.rules.virtual_success,callback:function(e){t.$set(t.model.rules,"virtual_success",e)},expression:"model.rules.virtual_success"}},[e("Radio",{attrs:{label:"1",disabled:t.isDisabled}},[t._v("开启")]),e("Radio",{attrs:{label:"0",disabled:t.isDisabled}},[t._v("关闭")])],1),e("kdx-hint-text",[t._v("开启模拟成团后，拼团有效期内人数未满的团，系统将会模拟“匿名买家”凑满人数，使该团成团。")]),e("kdx-hint-text",{staticStyle:{"padding-top":"0"}},[t._v("你只需要对已付款参团的真实买家发货。建议合理开启，以提高成团率。")]),1==t.model.rules.virtual_success?e("FormItem",{staticClass:"marginB-0 paddingT-10",attrs:{label:"最多支持虚拟",prop:"rules.virtual_success_num"}},[e("kdx-rr-input",{staticClass:"width-160",attrs:{placeholder:"请输入1-100",number:"",fixed:0,"min-value":1,"max-value":100,disabled:t.isDisabled},model:{value:t.model.rules.virtual_success_num,callback:function(e){t.$set(t.model.rules,"virtual_success_num",e)},expression:"model.rules.virtual_success_num"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("人")])])],1):t._e()],1),e("FormItem",{attrs:{label:"分销："}},[e("RadioGroup",{model:{value:t.model.rules.is_commission,callback:function(e){t.$set(t.model.rules,"is_commission",e)},expression:"model.rules.is_commission"}},[e("Radio",{attrs:{label:"1",disabled:t.isDisabled}},[t._v("参与")]),e("Radio",{attrs:{label:"0",disabled:t.isDisabled}},[t._v("不参与")])],1),e("kdx-hint-text",{staticStyle:{"max-width":"610px"}},[t._v("默认不参与分销，分销开启后才能生效，如果活动内包含未设置分销的商品，选择后也不会产生分佣 ")])],1),e("FormItem",{attrs:{label:"优惠券："}},[e("RadioGroup",{model:{value:t.model.rules.use_coupon,callback:function(e){t.$set(t.model.rules,"use_coupon",e)},expression:"model.rules.use_coupon"}},[e("Radio",{attrs:{label:"1",disabled:t.isDisabled}},[t._v("支持")]),e("Radio",{attrs:{label:"0",disabled:t.isDisabled}},[t._v("不支持")])],1),e("kdx-hint-text",[t._v("开启支持叠加使用优惠券则该活动商品支持使用平台内满足条件的优惠券")])],1),e("FormItem",{staticClass:"limit-type",attrs:{label:"限购次数："}},[e("RadioGroup",{attrs:{vertical:""},model:{value:t.model.rules.limit_type,callback:function(e){t.$set(t.model.rules,"limit_type",e)},expression:"model.rules.limit_type"}},[e("Radio",{attrs:{label:"0",disabled:t.isDisabled}},[t._v("不限制")]),e("Radio",{attrs:{label:"1",disabled:t.isDisabled}},[e("FormItem",{staticClass:"radio-item limit1",attrs:{prop:"rules.limit_num1"}},[e("div",{staticClass:"flex"},[e("span",[t._v("活动期内每人最多购买")]),e("kdx-rr-input",{staticClass:"width-160",attrs:{placeholder:"请输入",number:"",fixed:0,"max-value":999999999,"min-value":1,disabled:t.isDisabled},model:{value:t.model.rules.limit_num1,callback:function(e){t.$set(t.model.rules,"limit_num1",e)},expression:"model.rules.limit_num1"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])])],1),e("kdx-hint-text",[t._v("若开启，活动期间内每人每件商品最多支持购买数量，如商品A活动期间最多支持购买200件")])],1)],1),e("Radio",{attrs:{label:"2",disabled:t.isDisabled}},[e("FormItem",{staticClass:"radio-item limit2",attrs:{prop:"rules.limit_num2"}},[e("div",{staticClass:"flex"},[e("span",[t._v("活动期内每人每天最多购买")]),e("kdx-rr-input",{staticClass:"width-160",attrs:{placeholder:"请输入",number:"",fixed:0,"max-value":999999999,"min-value":1,disabled:t.isDisabled},model:{value:t.model.rules.limit_num2,callback:function(e){t.$set(t.model.rules,"limit_num2",e)},expression:"model.rules.limit_num2"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])])],1),e("kdx-hint-text",[t._v("若开启，活动期间内每人每天针对单个商品最多购买数量，如每人每天最多购买商品A200件")])],1)],1)],1)],1),e("FormItem",{attrs:{label:"商品单购：",prop:"rules.single_buy"}},[e("RadioGroup",{model:{value:t.model.rules.single_buy,callback:function(e){t.$set(t.model.rules,"single_buy",e)},expression:"model.rules.single_buy"}},[e("Radio",{attrs:{label:"1",disabled:t.isDisabled}},[t._v("支持")]),e("Radio",{attrs:{label:"0",disabled:t.isDisabled}},[t._v("不支持")])],1),e("kdx-hint-text",[t._v("开启后，商品详情展示单独购买按钮，支持用户单独购买")])],1),e("FormItem",{attrs:{label:"活动预热：",prop:"is_preheat"}},[e("RadioGroup",{model:{value:t.model.is_preheat,callback:function(e){t.$set(t.model,"is_preheat",e)},expression:"model.is_preheat"}},[e("Radio",{attrs:{label:"1",disabled:t.disabledPreheat}},[t._v("开启")]),e("Radio",{attrs:{label:"0",disabled:t.disabledPreheat}},[t._v("不开启")])],1),e("kdx-hint-text",[t._v("开启后，商品详情展示未开始的拼团活动，但活动开始前用户无法拼团购买。")]),"1"===t.model.is_preheat?e("div",{staticClass:"next-box"},[e("FormItem",{attrs:{label:"预热时间：",prop:"preheat_time"}},[e("DatePicker",{staticClass:"width-340",attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"请选择预热时间",disabled:t.disabledPreheat,value:t.model.preheat_time},on:{"on-change":t.changeTime}})],1)],1):t._e()],1)],1),e("goods-selector",{attrs:{multiple:!0,"current-list":t.model.goods_info,flag:"presell",show_activity:1,is_prescription:1},on:{"on-change":t.changeGoods,"on-cancel":t.cancelGoods},model:{value:t.goodsSelector.value,callback:function(e){t.$set(t.goodsSelector,"value",e)},expression:"goodsSelector.value"}})],1)};e.render=i;var a=[];e.staticRenderFns=a},"39ac":function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(i("c7eb")),o=a(i("1da1")),n=a(i("5530"));i("d9e2"),i("a434"),i("d3b7"),i("e9c4"),i("159b"),i("d81d"),i("14d9"),i("a15b");var r=i("2f62"),l=a(i("0659")),d=a(i("1f116")),c=a(i("c80d")),u=a(i("84187")),p={name:"RulesInfo",components:{GoodsSelector:l.default,RulesGoods:d.default,LadderGroupNum:c.default,LadderRulesGoods:u.default},props:{type:{type:String,default:""},activityData:{type:Object,default:function(){}},basicInfo:{type:Object,default:function(){}},isDisabled:{type:Boolean,default:!1},id:{type:String}},data:function(){var t=this;return{model:{is_commission:"0",limit_type:"0",limit_num1:null,limit_num2:null,is_preheat:"0",preheat_time:""},rule:{goods_info:[{required:!0,type:"array",min:1,message:"请选择商品"}],"rules.limit_num1":[{validator:function(e,i,a){"1"!=t.model.rules.limit_type||i||0===i?a():a(new Error("请填写数量"))}}],"rules.limit_num2":[{validator:function(e,i,a){"2"!=t.model.rules.limit_type||i||0===i?a():a(new Error("请填写数量"))}}],preheat_time:[{required:!0,validator:function(e,i,a){var s,o,n=null===(s=t.basicInfo)||void 0===s||null===(o=s.activity_time)||void 0===o?void 0:o[0];i?n&&i>n?a(new Error("预热时间不能大于开始时间")):a():a(new Error("请设置预热时间"))}}],hour:[{required:!0,message:"拼团有效期必填"}],minute:[{required:!0,message:"拼团有效期，分钟必填"},{validator:function(e,i,a){0==t.model.hour&&0==i&&a("拼团有效期不可为0"),a()}}],"rules.success_num":[{required:!0,message:"成团人数必填"}],"rules.virtual_success_num":[{validator:function(e,i,a){if(i||a(new Error("虚拟成团人数必填")),i=parseFloat(i),0==t.model.inner_type){var s=t.model.rules.success_num||2;s<=i&&a(new Error("虚拟成团人数要小于成团人数"))}else{var o,n=(null===(o=t.model.group_num_list[t.model.group_num_list.length-1])||void 0===o?void 0:o.num)||2;n<=i&&a(new Error("虚拟成团人数要小于成团人数"))}a()}}]},goodsSelector:{value:!1},cache:{goodsList:[],ladderGoodsList:[]}}},computed:(0,n.default)((0,n.default)((0,n.default)({},(0,r.mapGetters)("config",["getAppPermMap"])),(0,r.mapState)("config",["apps"])),{},{disabledPreheat:function(){var t;return(null===(t=this.activityData)||void 0===t?void 0:t.status)&&this.activityData.status<0||"view"==this.$route.query.type},isShowGoodsList:function(){var t,e;return null===(t=this.model)||void 0===t||null===(e=t.goods_info)||void 0===e?void 0:e.length}}),created:function(){},watch:{activityData:{handler:function(t){this.model=t},immediate:!0},model:{handler:function(t){this.$emit("update:activityData",t)},deep:!0}},methods:{handleDelete:function(t){this.model.goods_info.splice(t,1)},validateForm:function(){var t=this;return new Promise((function(e,i){t.$refs["rules_form"].validate(function(){var a=(0,o.default)((0,s.default)().mark((function a(o){return(0,s.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!o){a.next=16;break}if(!t.id){a.next=4;break}return e(),a.abrupt("return");case 4:if(0!=t.model.inner_type){a.next=9;break}return a.next=7,t.$refs["goods_rule"].validateForm();case 7:a.next=13;break;case 9:return a.next=11,t.$refs["ladder_group_num"].validateForm();case 11:return a.next=13,t.$refs["goods_ladder_goods"].validateForm();case 13:e(),a.next=17;break;case 16:i();case 17:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}())}))},changeTime:function(t){this.model.preheat_time=t},addGoods:function(){this.goodsSelector.value=!0},changeGoods:function(t){this.model.goods_info=t},cancelGoods:function(){this.goodsSelector.value=!1},changeType:function(t){1==t?(this.cache.goodsList=JSON.parse(JSON.stringify(this.model.goods_info)),this.model.goods_info=this.cache.ladderGoodsList):(this.cache.ladderGoodsList=JSON.parse(JSON.stringify(this.model.goods_info)),this.model.goods_info=this.cache.goodsList)},getParams:function(){var t=this.getGoodsInfoParams(),e=Object.assign({},{rules:JSON.parse(JSON.stringify(this.model.rules))},t);return e.rules.limit_time=60*this.model.hour+1*this.model.minute,e.is_preheat=this.model.is_preheat,1==e.is_preheat&&(e.preheat_time=this.model.preheat_time||""),e.inner_type=this.model.inner_type,e.rules.virtual_success_num=0==e.rules.vitrual_success?"0":e.rules.virtual_success_num,0==e.rules.limit_type?delete e.rules.limit_num:e.rules.limit_num=1==e.rules.limit_type?e.rules.limit_num1||"":e.rules.limit_num2||"",1==this.model.inner_type&&(e.rules.success_num={},this.model.group_num_list.forEach((function(t,i){e.rules.success_num[i+1]=t.num}))),delete e.rules.limit_num1,delete e.rules.limit_num2,e.rules=JSON.stringify(e.rules),console.log("params--------",e),e},getGoodsInfoParams:function(){var t=this,e=[],i=[],a=this.model.goods_info.map((function(a){e.push(a.id);var s={};return 1==a.has_option?(a.rules.forEach((function(t){i.push(t.option_id)})),s={goods_id:a.id,has_option:"1",rules:a.rules}):(s={goods_id:a.id,option_id:"0",has_option:"0",activity_stock:a.activity_stock,leader_price:a.leader_price||"-1"},0==t.model.inner_type?s.activity_price=a.activity_price:(s.activity_price="0",s.ladder_price={},t.model.group_num_list.forEach((function(t,e){s.ladder_price[e+1]=a["activity_price".concat(e+1)]})))),s}));return{goods_ids:e.join(","),option_ids:i.join(","),goods_info:a}}}};e.default=p},"3c5a":function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(i("c7eb")),o=a(i("1da1"));i("d9e2"),i("d3b7"),i("a15b");var n={name:"BasicInfo",props:{data:{type:Object,default:function(){}},isDisabled:{type:Boolean,default:!1},status:{type:String,default:""},type:{type:String,default:""}},data:function(){var t=this;return{old_end_time:"",model:{title:"",client_type:[],start_time:"",end_time:""},rule:{title:[{required:!0,message:"请填写活动名称"}],client_type:[{required:!0,message:"请选择活动渠道"}],start_time:[{required:!0,message:"请选择活动开始日期"}],end_time:[{required:!0,message:"请选择活动结束日期"},{validator:function(e,i,a){i?new Date(i)<new Date(t.model.start_time)?a(new Error("结束日期不能小于开始日期")):a():a(new Error("请选择活动结束日期"))}}]},dateOptions:{disabledDate:function(e){return t.editabled?new Date(e)<=new Date(t.old_end_time):!t.model.start_time||new Date(e).getTime()+863e5<new Date(t.model.start_time).getTime()}}}},computed:{editabled:function(){return("0"==this.status||"1"==this.status)&&"edit"==this.type||"view"==this.type}},watch:{data:{handler:function(t){this.editabled&&(this.old_end_time=t.end_time),this.model=Object.assign({},t)}}},methods:{validateForm:function(){var t=this;return new Promise((function(e,i){t.$refs["form"].validate(function(){var t=(0,o.default)((0,s.default)().mark((function t(a){return(0,s.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a?e():i();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))},getParams:function(){return{title:this.model.title,client_type:this.model.client_type.join(","),start_time:this.model.start_time,end_time:this.model.end_time}},changeStartTime:function(t){this.model.start_time=t},changeEndTime:function(t){this.model.end_time=t}}};e.default=n},"3d60":function(t,e,i){"use strict";i.r(e);var a=i("5550"),s=i("9231");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("f1a9");var n=i("2877"),r=Object(n["a"])(s["default"],a["render"],a["staticRenderFns"],!1,null,"24879236",null);e["default"]=r.exports},"52be":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("d9e2"),i("14d9"),i("a434"),i("d3b7");var a={name:"LadderGroupNum",props:{isDisabled:{type:Boolean,default:!1},data:{type:Array,default:function(){return[{num:2}]}}},data:function(){var t=this;return{model:{list:[]},list:[],item:{},rules:{num:[{validator:function(e,i,a){var s=e.field.split(".")[1];if(i){if(i=parseInt(i),s>0){var o,n,r=t.model.list[s-1].num,l=null===(o=t.model.list)||void 0===o||null===(n=o[s+1])||void 0===n?void 0:n.num;r&&r>=i?a("要大于上一阶梯人数"):l&&l<=i&&a("要比下一阶梯的小")}a()}else a(new Error("拼团人数不能为空"))}}]}}},mounted:function(){var t;this.model.list=null!==(t=this.data)&&void 0!==t&&t.length?this.data:[{num:2}]},watch:{},methods:{handleAdd:function(){this.model.list.push({num:""}),this.updateData()},changeNum:function(t,e){this.model.list[t].num=e.target.value,this.updateData()},handleDelete:function(){this.model.list.splice(this.model.list.length-1,1),this.updateData()},updateData:function(){this.$emit("update:data",this.model.list)},validateForm:function(){var t=this;return new Promise((function(e,i){t.$refs["form"].validate((function(t){t?e():i()}))}))}}};e.default=a},5550:function(t,e,i){"use strict";var a=i("32a3");i.o(a,"render")&&i.d(e,"render",(function(){return a["render"]})),i.o(a,"staticRenderFns")&&i.d(e,"staticRenderFns",(function(){return a["staticRenderFns"]}))},"55a7":function(t,e,i){},"577b":function(t,e,i){},"62fb":function(t,e,i){"use strict";var a=i("e1f2");i.o(a,"render")&&i.d(e,"render",(function(){return a["render"]})),i.o(a,"staticRenderFns")&&i.d(e,"staticRenderFns",(function(){return a["staticRenderFns"]}))},"68e2":function(t,e,i){"use strict";i("c35d")},"6bc4":function(t,e,i){"use strict";i.r(e);var a=i("a347"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},"7a6b":function(t,e,i){"use strict";i.r(e);var a=i("e323"),s=i("0733");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("bc6e");var n=i("2877"),r=Object(n["a"])(s["default"],a["render"],a["staticRenderFns"],!1,null,"771f6f13",null);e["default"]=r.exports},"7cf3":function(t,e,i){},"7f2a":function(t,e,i){"use strict";i.r(e);var a=i("d1dc"),s=i("82f4");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("deec");var n=i("2877"),r=Object(n["a"])(s["default"],a["render"],a["staticRenderFns"],!1,null,"3e68ca4c",null);e["default"]=r.exports},"82f4":function(t,e,i){"use strict";i.r(e);var a=i("3210"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},84187:function(t,e,i){"use strict";i.r(e);var a=i("ea0d"),s=i("ae22");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("68e2");var n=i("2877"),r=Object(n["a"])(s["default"],a["render"],a["staticRenderFns"],!1,null,"c49d3ed0",null);e["default"]=r.exports},"8fa0":function(t,e,i){"use strict";i.r(e);var a=i("52be"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},9231:function(t,e,i){"use strict";i.r(e);var a=i("9fd4"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},"9ac3":function(t,e,i){"use strict";i("55a7")},"9fd4":function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(i("c7eb")),o=a(i("1da1")),n=a(i("2909")),r=a(i("5530"));i("a9e3"),i("d9e2"),i("d3b7"),i("d81d"),i("99af"),i("4e82"),i("159b"),i("14d9");var l={name:"SpecificationsRules",components:{},props:{value:{type:Boolean,default:!1},goodsId:{type:[String,Number],default:""},type:{type:String,default:""},spaceRules:{type:Array,default:function(){return[]}},isDisabled:{type:Boolean,default:!1}},data:function(){var t=this;this.$createElement;return{loading:!1,modal:!1,specs:[],form:{goodsList:[]},colspan:{0:1,1:1,2:1},batchData:{activity_stock:"",activity_price:"",leader_price:"",is_join:"0"},submitValid:!1,columns:[],defaultColumns:[{title:"售卖价",key:"price",render:function(t,e){return t("div",["￥"+e.row.price])}},{title:"总库存",key:"stock",width:80,render:function(t,e){return t("div",[e.row.stock])}},{title:"参与拼团",slot:"is_join",width:100},{title:"拼团库存",slot:"activity_stock"},{title:"拼团价格",slot:"activity_price"},{title:"团长价(非必填)",slot:"leader_price"}],rules:{is_join:[],activity_price:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=t.form.goodsList[s],n=o.price,r=o.is_join;if("1"!=r)return a();Number(n)<=Number(i)?a(new Error("拼团价格需小于售价")):"1"!=r||i?a():a(new Error("拼团价格不能为空"))}}],activity_stock:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=t.form.goodsList[s],n=o.stock,r=o.is_join;if("1"!=r)return a();Number(n)<Number(i)?a(new Error("拼团库存大于库存")):i?0===Number(i)?a(new Error("拼团库存不能为0")):a():a(new Error("拼团库存不能为空"))}}],leader_price:[{validator:function(e,i,a){var s,o;i=Number(i);var n=e.field.split(".")[1],r=t.form.goodsList[n].is_join,l=Number(null===(s=t.form.goodsList[n])||void 0===s?void 0:s.price),d=Number((null===(o=t.form.goodsList[n])||void 0===o?void 0:o.activity_price)||l);1==r&&i&&(l<=i?a(new Error("团长价格需小于售售卖价")):d<=i&&a(new Error("团长价格需小于拼团价格"))),a()}}]}}},watch:{goodsId:{handler:function(t){t&&this.getGoodsData(t)},immediate:!0},value:function(t){this.getGoodsData(this.goodsId),this.handleColumns(),this.refreshInput(),this.modal=t}},computed:{allSeckill:{get:function(){return this.form.goodsList.every((function(t){return"1"==t.is_join}))?"1":"0"},set:function(t){this.batchData.is_join=t}}},methods:{getGoodsData:function(t){var e=this;this.loading=!0,this.$api.goodsApi.getGoodInformation({id:t}).then((function(t){if(0===t.error){e.specs=t.data.spec;var i=t.data.options.map((function(t){return e.spaceRules.length>0?e.spaceRules.map((function(i){var a=e.isDisabled?"id":"option_id";t.id==i[a]&&(t.activity_stock=(null===i||void 0===i?void 0:i.activity_stock)||"",t.activity_price=(null===i||void 0===i?void 0:i.activity_price)||"",t.is_join=(null===i||void 0===i?void 0:i.is_join)||"0",t.leader_price=-1==(null===i||void 0===i?void 0:i.leader_price)?"":null===i||void 0===i?void 0:i.leader_price)})):(t.activity_stock="",t.activity_price="",t.is_join="0",t.leader_price=""),(0,r.default)({},t)}));e.handleColumns(),e.initTable(i),e.initColspan(),e.loading=!1}}))},handleColumns:function(){this.initColumns(this.defaultColumns)},initColumns:function(t){this.$createElement;var e=this.specs.map((function(t,e){return{title:t.title,key:"",render:function(t,i){return t("div",[i.row.childSpecVal[e]])}}}));this.columns=[].concat((0,n.default)(e),(0,n.default)(t))},initTable:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length>1?this.form.goodsList=e.sort((function(t,e){for(var i=t.specs.split(",").map((function(t){return parseInt(t)})),a=e.specs.split(",").map((function(t){return parseInt(t)})),s=Math.min(i.length,a.length),o=0;o<s;o++)if(i[o]!==a[o])return i[o]-a[o]})):this.form.goodsList=e,this.form.goodsList.forEach((function(e){var i=[];t.specs.forEach((function(t){t.items.forEach((function(t){e.specs.indexOf(t.id)>-1&&i.push(t.title)}))})),e.childSpecVal=i}))},initColspan:function(){var t={0:1,1:1,2:1};this.specs.forEach((function(e,i){e.items.length>0&&(t[i]=e.items.length)})),t[0]=t[1]*(t[2]||1)||1,t[1]=t[2]||1,t[2]=t[2]?1:0,this.colspan=t},handleSpan:function(t){var e=t.rowIndex,i=t.columnIndex,a={rowspan:0,colspan:1};return i<this.specs.length?(e%this.colspan[i]==0&&(a={rowspan:this.colspan[i],colspan:1}),a):[1,1]},handleCancel:function(){this.modal=!1,this.$emit("input",this.modal)},validateForm:function(){var t=this;return new Promise((function(e,i){t.$refs["goodsForm"].validate((function(a){t.submitValid=!1,a?t.form.goodsList.some((function(t){return"1"==t.is_join}))?e():(t.$Message.error("请至少选择一个规格参加活动"),i()):i()}))}))},handleOK:function(){var t=this;return(0,o.default)((0,s.default)().mark((function e(){var i;return(0,s.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.submitValid=!0,e.next=3,t.validateForm();case 3:i={id:t.goodsId,rules:t.form.goodsList.map((function(t){return{option_id:t.id,activity_stock:t.activity_stock,activity_price:t.activity_price,leader_price:t.leader_price||"-1",is_join:t.is_join}}))},t.$emit("spaceGoods",i),t.handleCancel();case 6:case"end":return e.stop()}}),e)})))()},changeSeckill:function(t){this.form.goodsList.map((function(e){e.is_join=t}))},handleBatchChange:function(){var t=this;this.form.goodsList.forEach((function(e){t.batchData.activity_price&&(e.activity_price=t.batchData.activity_price),t.batchData.activity_stock&&(e.activity_stock=t.batchData.activity_stock),e.leader_price=t.batchData.leader_price}))},refreshInput:function(){this.batchData=(0,r.default)((0,r.default)({},this.batchData),{},{activity_stock:"",activity_price:"",leader_price:""})}}};e.default=l},a02b:function(t,e,i){"use strict";i.r(e);var a=i("1b58"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},a0a4:function(t,e,i){"use strict";i.r(e);var a=i("fe8a"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},a347:function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("d3b7"),i("ac1f"),i("5319"),i("d81d"),i("b64b"),i("159b");var s=a(i("c7eb")),o=a(i("1da1")),n=a(i("5530")),r=a(i("15fd")),l=a(i("7f2a")),d=a(i("7a6b")),c=a(i("d63a")),u=["title","client_type","start_time","end_time","preheat_time","rules","goods_info"],p={name:"index",components:{preview:l.default,basicInfo:d.default,rulesInfo:c.default},data:function(){return{activityData:{inner_type:"0",hour:"",minute:"",is_preheat:"0",preheat_time:"",rules:{success_num:2,virtual_success:"0",virtual_success_num:"",is_commission:"0",use_coupon:"0",limit_type:"0",single_buy:"1",use_platform_coupon:"0"},goods_info:[],group_num_list:[{num:2}]},basicInfoData:{title:"",client_type:[],start_time:"",end_time:""},loading:!1,submitLoading:!1,id:"",type:"",status:""}},created:function(){var t=this.$route.query,e=t.id,i=t.type;this.id=e,this.type=i,this.id&&this.getGroupsActivityDetail()},computed:{isDisabled:function(){return"add"!==this.type&&"copy"!==this.type},isSaveBtnDisabled:function(){var t,e;return"copy"!=this.type&&(-1===+(null===(t=this.activityData)||void 0===t?void 0:t.status)||-2===+(null===(e=this.activityData)||void 0===e?void 0:e.status)||"view"==this.type)}},methods:{getGroupsActivityDetail:function(){var t=this,e={id:this.id};"copy"==this.type&&(e.copy=1),this.loading=!0,this.$api.groupsApi.getGroupsActivityDetail(e).then((function(e){if(t.loading=!1,0===e.error){"copy"==t.type&&(e.data.title="副本-".concat(e.data.title));var i=e.data,a=i.title,s=i.client_type,o=i.start_time,l=i.end_time,d=i.preheat_time,c=i.rules,p=i.goods_info,f=(0,r.default)(i,u);"0000-00-00 00:00:00"==d&&(d=""),c.limit_num1="",c.limit_num2="",1==c.limit_type?c.limit_num1=c.limit_num:2==c.limit_type&&(c.limit_num2=c.limit_num),t.activityData=(0,n.default)((0,n.default)({rules:c},f),{},{preheat_time:d,goods_info:p}),t.activityData.hour=Math.floor(t.activityData.rules.limit_time/60),t.activityData.minute=t.activityData.rules.limit_time%60,t.formatLadderInfo(),t.status=f.status,t.basicInfoData={title:a,client_type:(null===s||void 0===s?void 0:s.split(","))||[],start_time:o,end_time:l}}}))},handleSave:function(){var t=this;return(0,o.default)((0,s.default)().mark((function e(){var i,a,o,n;return(0,s.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.id){e.next=4;break}return e.next=4,t.$refs.basicInfo.validateForm();case 4:return e.next=6,t.$refs.rulesInfo.validateForm();case 6:i=t.$refs.basicInfo.getParams(),a=t.$refs.rulesInfo.getParams(),t.id&&"copy"!=t.type?(o={id:t.id,is_preheat:a.is_preheat,preheat_time:1==a.is_preheat?a.preheat_time:"",end_time:i.end_time},t.editActivity(o)):(n=Object.assign(i,a),t.saveActivity(n)),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),t.submitLoading=!1;case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()},saveActivity:function(t){var e=this;this.submitLoading=!0,this.$api.groupsApi.addGroupsActivity(t).then((function(t){0===t.error&&(e.$Message.success("保存成功"),e.$router.replace({path:"/groups/activity/list"}))})).finally((function(){e.submitLoading=!1}))},editActivity:function(t){var e=this;this.submitLoading=!0,this.$api.groupsApi.editGroupsActivity(t).then((function(t){0===t.error&&(e.$Message.success("编辑成功"),e.$router.replace({path:"/groups/activity/list"}))})).finally((function(){e.submitLoading=!1}))},formatLadderInfo:function(){var t=this,e=this.activityData.rules,i=this.activityData.goods_info;1==this.activityData.inner_type&&(this.activityData.group_num_list=Object.keys(e.success_num).map((function(t){return{num:e.success_num[t]}}))),i.forEach((function(e){e.has_option||(e.leader_price=-1==e.leader_price?"":e.leader_price,1==t.activityData.inner_type&&Object.keys(e.ladder_price).forEach((function(t){e["activity_price".concat(t)]=e.ladder_price[t]})))}))}}};e.default=p},ad14:function(t,e,i){},ae22:function(t,e,i){"use strict";i.r(e);var a=i("30d5"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},bbb4:function(t,e,i){"use strict";i.r(e);var a=i("39ac"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},bc66:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.staticRenderFns=e.render=void 0;var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"spell-group-index"},[e("preview",{attrs:{activityData:t.activityData}}),e("div",{staticClass:"right"},[e("kdx-content-bar",{scopedSlots:t._u([{key:"btn",fn:function(){return[e("Button",{staticClass:"primary-long",attrs:{type:"primary",disabled:t.isSaveBtnDisabled,loading:t.submitLoading},on:{click:t.handleSave}},[t._v("保存")]),e("Button",{staticClass:"default-long",attrs:{to:"/groups/activity/list"}},[t._v("取消")])]},proxy:!0}])},[e("div",{staticClass:"content"},[e("basic-info",{ref:"basicInfo",attrs:{type:t.type,data:t.basicInfoData,status:t.status,"is-disabled":t.isDisabled},on:{"update:data":function(e){t.basicInfoData=e}}}),e("rules-info",{ref:"rulesInfo",attrs:{type:t.type,activityData:t.activityData,"basic-info":t.basicInfoData,id:t.id,"is-disabled":t.isDisabled},on:{"update:activityData":function(e){t.activityData=e},"update:activity-data":function(e){t.activityData=e}}})],1)])],1)],1)};e.render=i;var a=[];e.staticRenderFns=a},bc6e:function(t,e,i){"use strict";i("ad14")},c35d:function(t,e,i){},c80d:function(t,e,i){"use strict";i.r(e);var a=i("d85c"),s=i("8fa0");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("f052");var n=i("2877"),r=Object(n["a"])(s["default"],a["render"],a["staticRenderFns"],!1,null,"8ab7505e",null);e["default"]=r.exports},cf6e:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.staticRenderFns=e.render=void 0;var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"rules-goods-table"},[e("Form",{ref:"goodsForm",attrs:{model:t.form,rules:t.rules}},[e("Table",{attrs:{columns:t.columns,data:t.form.goodsList},scopedSlots:t._u([{key:"shop",fn:function(i){var a=i.row;return[e("div",{staticClass:"shop-box"},[e("div",{staticClass:"image"},[e("img",{attrs:{src:t.$media(a.thumb)},on:{error:t.replaceImage}})]),e("div",{staticClass:"title-content"},[e("div",{staticClass:"content-text"},[e("span",{staticClass:"mark",style:1==a.has_option?"display:inline-block":"display:none"},[t._v("多")]),e("span",{staticClass:"mark",class:t.goodsType(a.type).goodsName},[t._v(t._s(t.goodsType(a.type).goodsText))]),e("span",{staticClass:"text"},[t._v(t._s(a.title))])])])])]}},{key:"price",fn:function(i){var a=i.row;return[e("div",{staticClass:"price"},[1==a.has_option?e("div",{staticClass:"flex-wrap"},[e("div",[t._v("￥"+t._s(a.min_price))]),e("div",[t._v("~")]),e("div",[t._v("￥"+t._s(a.max_price))])]):e("span",[t._v("￥"+t._s(a.price))])])]}},{key:"stock",fn:function(i){var a=i.row;return[e("div",[t._v(t._s(parseInt(a.stock)>999?"999+":parseInt(a.stock)))])]}},{key:"rules",fn:function(i){var a=i.row,s=i.index;return[1==a.has_option?e("div",{staticClass:"deposit-btn"},[t.isSetRules(a)?e("Button",{staticClass:"default-primary on-set",on:{click:function(e){return t.handleSelectOption(a.id)}}},[t._v("已设置（可点击修改） ")]):e("Button",{staticClass:"default-primary off-set",on:{click:function(e){return t.handleSelectOption(a.id)}}},[t._v("未设置拼团库存及价格 ")])],1):e("div",{staticClass:"flex"},[e("div",{staticClass:"table-input"},[e("FormItem",{attrs:{prop:"goodsList.".concat(s,".activity_stock"),rules:t.rules.activity_stock}},[e("kdx-rr-input",{attrs:{type:"text",number:"",fixed:0,maxValue:999999999,disabled:t.isDisabled},model:{value:t.form.goodsList[s].activity_stock,callback:function(e){t.$set(t.form.goodsList[s],"activity_stock",e)},expression:"form.goodsList[index].activity_stock"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])])],1)],1),e("div",{staticClass:"table-input"},[e("FormItem",{attrs:{prop:"goodsList.".concat(s,".activity_price"),rules:t.rules.activity_price}},[e("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[s].activity_price,callback:function(e){t.$set(t.form.goodsList[s],"activity_price",e)},expression:"form.goodsList[index].activity_price"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)],1),e("div",{staticClass:"table-input"},[e("FormItem",{attrs:{prop:"goodsList.".concat(s,".leader_price"),rules:t.rules.leader_price}},[e("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[s].leader_price,callback:function(e){t.$set(t.form.goodsList[s],"leader_price",e)},expression:"form.goodsList[index].leader_price"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)],1)])]}}])})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.form.goodsList&&t.form.goodsList.length>0,expression:"form.goodsList && form.goodsList.length > 0"}],staticClass:"footer-page"},[e("kdx-page-component",{ref:"page",attrs:{size:"small",total:t.total},on:{"on-change":t.changePage}})],1),e("specifications-rules",{attrs:{goodsId:t.specificationsData.goodsId,type:t.type,"is-disabled":t.isDisabled,spaceRules:t.specificationsData.spaceRules},on:{spaceGoods:t.handleSpaceGoods},model:{value:t.specificationsData.rulesModal,callback:function(e){t.$set(t.specificationsData,"rulesModal",e)},expression:"specificationsData.rulesModal"}})],1)};e.render=i;var a=[];e.staticRenderFns=a},d050:function(t,e,i){"use strict";i.r(e);var a=i("62fb"),s=i("a0a4");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("9ac3");var n=i("2877"),r=Object(n["a"])(s["default"],a["render"],a["staticRenderFns"],!1,null,"aedcb7de",null);e["default"]=r.exports},d1dc:function(t,e,i){"use strict";var a=i("0bcf");i.o(a,"render")&&i.d(e,"render",(function(){return a["render"]})),i.o(a,"staticRenderFns")&&i.d(e,"staticRenderFns",(function(){return a["staticRenderFns"]}))},d43d:function(t,e,i){"use strict";var a=i("37e3");i.o(a,"render")&&i.d(e,"render",(function(){return a["render"]})),i.o(a,"staticRenderFns")&&i.d(e,"staticRenderFns",(function(){return a["staticRenderFns"]}))},d576:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.staticRenderFns=e.render=void 0;var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"ladder-group-num"},[t._m(0),e("div",{staticClass:"content"},[e("Form",{ref:"form",attrs:{model:t.model,rules:t.rules},nativeOn:{submit:function(t){t.preventDefault()}}},t._l(t.model.list,(function(i,a){return e("div",{key:a,staticClass:"content-item"},[e("div",{staticClass:"name"},[t._v(" 第 "+t._s(a+1)+" 阶梯 ")]),e("div",{staticClass:"group-num"},[e("FormItem",{attrs:{prop:"list.".concat(a,".num"),rules:t.rules.num}},[e("kdx-rr-input",{staticClass:"width-160",attrs:{placeholder:"请输入",value:i.num,number:"",fixed:0,"min-value":1,"max-value":100,disabled:t.isDisabled},on:{"on-change":function(e){return t.changeNum(a,e)}}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("人")])])],1)],1),e("div",{staticClass:"btn-del"},[e("Button",{directives:[{name:"show",rawName:"v-show",value:0!==a&&t.model.list.length==a+1,expression:"index !== 0 && model.list.length == index+1"}],attrs:{type:"text",disabled:t.isDisabled},on:{click:t.handleDelete}},[t._v("删除")])],1)])})),0)],1),t.model.list.length<3?e("div",{staticClass:"add"},[e("Button",{attrs:{type:"text",disabled:t.isDisabled},on:{click:t.handleAdd}},[t._v(" +添加拼团阶梯( "+t._s(t.model.list.length)+" / 3) ")])],1):t._e()])};e.render=i;var a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"header"},[e("div",{staticClass:"name"},[t._v(" 阶梯 ")]),e("div",{staticClass:"group-num"},[t._v(" 拼团人数 ")]),e("div",{staticClass:"btn-del"})])}];e.staticRenderFns=a},d63a:function(t,e,i){"use strict";i.r(e);var a=i("d43d"),s=i("bbb4");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("25b0");var n=i("2877"),r=Object(n["a"])(s["default"],a["render"],a["staticRenderFns"],!1,null,"cccdeda6",null);e["default"]=r.exports},d85c:function(t,e,i){"use strict";var a=i("d576");i.o(a,"render")&&i.d(e,"render",(function(){return a["render"]})),i.o(a,"staticRenderFns")&&i.d(e,"staticRenderFns",(function(){return a["staticRenderFns"]}))},dbae:function(t,e,i){},deec:function(t,e,i){"use strict";i("f8dc")},df95:function(t,e,i){"use strict";i.r(e);var a=i("1da0"),s=i("6bc4");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("2d67");var n=i("2877"),r=Object(n["a"])(s["default"],a["render"],a["staticRenderFns"],!1,null,"2d29f38e",null);e["default"]=r.exports},e1f2:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.staticRenderFns=e.render=void 0,i("99af");var a=function(){var t=this,e=t._self._c;return e("kdx-modal-frame",{attrs:{title:"设置拼团商品信息",value:t.modal,width:"1500","mask-closable":!1,loading:t.loading,footerHide:t.isDisabled},on:{"on-cancel":t.handleCancel,"on-ok":t.handleOK}},[e("div",{staticClass:"multi-specification"},[e("div",{staticClass:"setting flex"},[e("span",[t._v("批量设置：")]),e("div",{staticClass:"setting-input flex"},[e("Checkbox",{attrs:{"true-value":"1","false-value":"0",disabled:t.isDisabled},on:{"on-change":t.changeSeckill},model:{value:t.allSeckill,callback:function(e){t.allSeckill=e},expression:"allSeckill"}},[t._v("参与拼团 ")]),e("kdx-rr-input",{attrs:{type:"text",placeholder:"拼团库存",number:"",fixed:0,maxValue:999999999,disabled:t.isDisabled},model:{value:t.batchData.activity_stock,callback:function(e){t.$set(t.batchData,"activity_stock",e)},expression:"batchData.activity_stock"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])]),t.ladderNum.length?t._l(t.ladderNum,(function(i,a){return e("kdx-rr-input",{key:a,attrs:{type:"text",placeholder:"".concat(i.num,"人拼团价"),number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.batchData["activity_price".concat(a+1)],callback:function(e){t.$set(t.batchData,"activity_price".concat(a+1),e)},expression:"batchData[`activity_price${index + 1}`]"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])})):t._e(),e("kdx-rr-input",{attrs:{type:"text",placeholder:"团长价(非必填)",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.batchData.leader_price,callback:function(e){t.$set(t.batchData,"leader_price",e)},expression:"batchData.leader_price"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])]),e("Button",{staticClass:"default-primary",attrs:{disabled:t.isDisabled},on:{click:t.handleBatchChange}},[t._v("应用")])],2)]),e("div",{staticClass:"table-list"},[e("Form",{ref:"goodsForm",attrs:{model:t.form,rules:t.rules}},[e("Table",{ref:"table",attrs:{columns:t.columns,data:t.form.goodsList,"span-method":t.handleSpan},scopedSlots:t._u([{key:"is_join",fn:function(i){var a=i.index;return[e("FormItem",{attrs:{prop:"goodsList.".concat(a,".is_join"),rules:t.rules.is_join}},[e("Checkbox",{attrs:{"true-value":"1","false-value":"0",disabled:t.isDisabled},model:{value:t.form.goodsList[a].is_join,callback:function(e){t.$set(t.form.goodsList[a],"is_join",e)},expression:"form.goodsList[index].is_join"}},[t._v("参与 ")])],1)]}},{key:"activity_stock",fn:function(i){var a=i.index;return[e("FormItem",{attrs:{prop:"goodsList.".concat(a,".activity_stock"),rules:t.rules.activity_stock}},[e("kdx-rr-input",{attrs:{type:"text",number:"",fixed:0,maxValue:999999999,disabled:t.isDisabled},model:{value:t.form.goodsList[a].activity_stock,callback:function(e){t.$set(t.form.goodsList[a],"activity_stock",e)},expression:"form.goodsList[index].activity_stock"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])])],1)]}},{key:"activity_price",fn:function(i){var a=i.index;return[e("div",{staticClass:"flex"},[t.ladderNum.length?t._l(t.ladderNum,(function(i,s){return e("div",{key:s,staticClass:"table-input"},[e("FormItem",{attrs:{prop:"goodsList.".concat(a,".activity_price").concat(s+1),rules:t.rules["activity_price".concat(s+1)]}},[e("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[a]["activity_price".concat(s+1)],callback:function(e){t.$set(t.form.goodsList[a],"activity_price".concat(s+1),e)},expression:"form.goodsList[index][`activity_price${i+1}`]"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)],1)})):t._e()],2)]}},{key:"leader_price",fn:function(i){var a=i.index;return[e("FormItem",{attrs:{prop:"goodsList.".concat(a,".leader_price"),rules:t.rules.leader_price}},[e("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[a].leader_price,callback:function(e){t.$set(t.form.goodsList[a],"leader_price",e)},expression:"form.goodsList[index].leader_price"}},[e("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)]}}])})],1)],1)])])};e.render=a;var s=[];e.staticRenderFns=s},e323:function(t,e,i){"use strict";var a=i("f6db");i.o(a,"render")&&i.d(e,"render",(function(){return a["render"]})),i.o(a,"staticRenderFns")&&i.d(e,"staticRenderFns",(function(){return a["staticRenderFns"]}))},ea0d:function(t,e,i){"use strict";var a=i("221d");i.o(a,"render")&&i.d(e,"render",(function(){return a["render"]})),i.o(a,"staticRenderFns")&&i.d(e,"staticRenderFns",(function(){return a["staticRenderFns"]}))},f031:function(t,e,i){"use strict";var a=i("cf6e");i.o(a,"render")&&i.d(e,"render",(function(){return a["render"]})),i.o(a,"staticRenderFns")&&i.d(e,"staticRenderFns",(function(){return a["staticRenderFns"]}))},f052:function(t,e,i){"use strict";i("dbae")},f1a9:function(t,e,i){"use strict";i("03ca6")},f6db:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.staticRenderFns=e.render=void 0;var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"seckill-basic-info"},[e("Form",{ref:"form",attrs:{model:t.model,"label-width":120,rules:t.rule},nativeOn:{submit:function(t){t.preventDefault()}}},[e("kdx-form-title",[t._v("基本信息")]),e("FormItem",{attrs:{label:"活动名称：",prop:"title"}},[e("Input",{staticClass:"width-340",class:{"input-disabled":t.isDisabled},attrs:{placeholder:"请输入活动名称",maxlength:"20","show-word-limit":"",disabled:t.isDisabled},model:{value:t.model.title,callback:function(e){t.$set(t.model,"title",e)},expression:"model.title"}})],1),e("FormItem",{attrs:{label:"活动期限：",required:""}},[e("div",{staticClass:"flex"},[e("FormItem",{staticStyle:{"margin-bottom":"0"},attrs:{prop:"start_time"}},[e("DatePicker",{staticClass:"width-250",attrs:{value:t.model.start_time,type:"datetime",placeholder:"开始时间",disabled:t.editabled},on:{"on-change":t.changeStartTime}})],1),e("div",{staticClass:"marginL-10 marginR-10"},[t._v("~")]),e("FormItem",{staticStyle:{"margin-bottom":"0"},attrs:{prop:"end_time"}},[e("DatePicker",{staticClass:"width-250",attrs:{value:t.model.end_time,options:t.dateOptions,type:"datetime",placeholder:"结束时间",disabled:"view"==t.type},on:{"on-change":t.changeEndTime}})],1)],1)]),e("FormItem",{staticClass:"r-form-item-checkbox",attrs:{label:"活动渠道：",prop:"client_type"}},[e("CheckboxGroup",{model:{value:t.model.client_type,callback:function(e){t.$set(t.model,"client_type",e)},expression:"model.client_type"}},[e("Checkbox",{attrs:{label:"20",disabled:t.isDisabled}},[t._v(" 微信公众号 ")]),e("Checkbox",{attrs:{label:"21",disabled:t.isDisabled}},[t._v(" 微信小程序 ")]),e("Checkbox",{attrs:{label:"10",disabled:t.isDisabled}},[t._v(" 手机浏览器H5 ")]),e("Checkbox",{attrs:{label:"30",disabled:t.isDisabled}},[t._v(" 头条/抖音小程序 ")])],1)],1)],1)],1)};e.render=i;var a=[];e.staticRenderFns=a},f8dc:function(t,e,i){},fe8a:function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(i("c7eb")),o=a(i("1da1")),n=a(i("2909")),r=a(i("5530"));i("a9e3"),i("d9e2"),i("fb6a"),i("d3b7"),i("d81d"),i("159b"),i("99af"),i("4e82"),i("14d9");var l={name:"SpecificationsRules",components:{},props:{value:{type:Boolean,default:!1},goodsId:{type:[String,Number],default:""},type:{type:String,default:""},spaceRules:{type:Array,default:function(){return[]}},isDisabled:{type:Boolean,default:!1},ladderNum:{type:Array,default:function(){return[]}}},data:function(){var t=this;this.$createElement;return{loading:!1,modal:!1,specs:[],form:{goodsList:[]},colspan:{0:1,1:1,2:1},batchData:{activity_stock:"",activity_price1:"",activity_price2:"",activity_price3:"",leader_price:"",is_join:"0"},submitValid:!1,columns:[],specColumns:[],defaultColumns:[{title:"售卖价",key:"price",render:function(t,e){return t("div",["￥"+e.row.price])}},{title:"总库存",key:"stock",width:80,render:function(t,e){return t("div",[e.row.stock])}},{title:"参与拼团",slot:"is_join",width:100},{title:"拼团库存",slot:"activity_stock"}],ladderColumns:{},headColumn:{title:"团长价(非必填)",slot:"leader_price"},rules:{is_join:[],activity_price:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=t.form.goodsList[s],n=o.price,r=o.is_join;if("1"!=r)return a();Number(n)<=Number(i)?a(new Error("拼团价格需小于售价")):i?a():a(new Error("拼团价格不能为空"))}}],activity_stock:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=t.form.goodsList[s],n=o.stock,r=o.is_join;if("1"!=r)return a();Number(n)<Number(i)?a(new Error("拼团库存大于库存")):i?0===Number(i)?a(new Error("拼团库存不能为0")):a():a(new Error("拼团库存不能为空"))}}],activity_price1:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=t.form.goodsList[s],n=o.is_join,r=parseFloat(o.price);1==n&&(i?(i=parseFloat(i),r<=i&&a(new Error("拼团价格需小于售卖价"))):a(new Error("拼团价格不能为空"))),a()}}],activity_price2:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=e.field.slice(-1)-1,n=t.form.goodsList[s],r=n.is_join,l=parseFloat(n.price);if(1==r)if(i){i=parseFloat(i),l<i&&a(new Error("拼团价格需小于售卖价"));var d=n["activity_price".concat(o)];d&&parseFloat(d)<=i&&a(new Error("阶梯拼团价要比上一阶梯小"))}else a(new Error("拼团价格不能为空"));a()}}],activity_price3:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=e.field.slice(-1)-1,n=t.form.goodsList[s],r=n.is_join,l=parseFloat(n.price);if(1==r)if(i){i=parseFloat(i),l<i&&a(new Error("拼团价格需小于售卖价"));var d=n["activity_price".concat(o)];d&&d<=i&&a(new Error("阶梯拼团价要比上一阶梯小"))}else a(new Error("拼团价格不能为空"));a()}}],leader_price:[{validator:function(e,i,a){i=Number(i);var s=e.field.split(".")[1],o=t.form.goodsList[s],n=o.is_join,r=Number(null===o||void 0===o?void 0:o.price),l=Number((null===o||void 0===o?void 0:o["activity_price".concat(t.ladderNum.length)])||r);1==n&&i?r<=i?a(new Error("团长价格需小于售售卖价")):l<=i&&a(new Error("团长价格需小于拼团价格")):a(),a()}}]}}},watch:{goodsId:{handler:function(t){t&&this.getGoodsData(t)},immediate:!0},value:function(t){this.getGoodsData(this.goodsId),this.initColumns(),this.refreshInput(),this.modal=t},ladderNum:{handler:function(){this.setColumns()},immediate:!0,deep:!0}},computed:{allSeckill:{get:function(){return this.form.goodsList.every((function(t){return"1"==t.is_join}))?"1":"0"},set:function(t){this.batchData.is_join=t}}},methods:{getGoodsData:function(t){var e=this;this.loading=!0,this.$api.goodsApi.getGoodInformation({id:t}).then((function(t){if(0===t.error){e.specs=t.data.spec;var i=t.data.options.map((function(t){return e.spaceRules.length>0?e.spaceRules.map((function(i){var a=e.isDisabled?"id":"option_id";t.id==i[a]&&(t.activity_stock=(null===i||void 0===i?void 0:i.activity_stock)||"",t.is_join=(null===i||void 0===i?void 0:i.is_join)||"0",t.leader_price=-1==(null===i||void 0===i?void 0:i.leader_price)?"":null===i||void 0===i?void 0:i.leader_price,e.ladderNum.forEach((function(e,a){t["activity_price".concat(a+1)]=i.ladder_price[a+1]})))})):(t.activity_stock="",t.is_join="0",t.leader_price="",e.ladderNum.forEach((function(e,i){t["activity_price".concat(i+1)]=""}))),(0,r.default)({},t)}));e.initColumns(),e.initTable(i),e.initColspan(),e.loading=!1}}))},setColumns:function(){var t=this,e=this.$createElement,i=150*this.ladderNum.length;this.ladderColumns={slot:"activity_price",minWidth:i,renderHeader:function(){return e("div",{class:"flex"},[t.ladderNum.map((function(t){return e("p",{class:"table-title"},[t.num,"人拼团价"])}))])}},this.concatColumns()},initColumns:function(){this.$createElement;this.specColumns=this.specs.map((function(t,e){return{title:t.title,key:"",render:function(t,i){return t("div",[i.row.childSpecVal[e]])}}})),this.concatColumns()},concatColumns:function(){this.columns=[].concat((0,n.default)(this.specColumns),(0,n.default)(this.defaultColumns),[this.ladderColumns,this.headColumn])},initTable:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length>1?this.form.goodsList=e.sort((function(t,e){for(var i=t.specs.split(",").map((function(t){return parseInt(t)})),a=e.specs.split(",").map((function(t){return parseInt(t)})),s=Math.min(i.length,a.length),o=0;o<s;o++)if(i[o]!==a[o])return i[o]-a[o]})):this.form.goodsList=e,this.form.goodsList.forEach((function(e){var i=[];t.specs.forEach((function(t){t.items.forEach((function(t){e.specs.indexOf(t.id)>-1&&i.push(t.title)}))})),e.childSpecVal=i}))},initColspan:function(){var t={0:1,1:1,2:1};this.specs.forEach((function(e,i){e.items.length>0&&(t[i]=e.items.length)})),t[0]=t[1]*(t[2]||1)||1,t[1]=t[2]||1,t[2]=t[2]?1:0,this.colspan=t},handleSpan:function(t){var e=t.rowIndex,i=t.columnIndex,a={rowspan:0,colspan:1};return i<this.specs.length?(e%this.colspan[i]==0&&(a={rowspan:this.colspan[i],colspan:1}),a):[1,1]},handleCancel:function(){this.modal=!1,this.$emit("input",this.modal)},validateForm:function(){var t=this;return new Promise((function(e,i){t.$refs["goodsForm"].validate((function(a){t.submitValid=!1,a?t.form.goodsList.some((function(t){return 1==t.is_join}))?e():(t.$Message.error("请至少选择一个规格参加活动"),i()):i()}))}))},handleOK:function(){var t=this;return(0,o.default)((0,s.default)().mark((function e(){var i;return(0,s.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.submitValid=!0,e.next=3,t.validateForm();case 3:i={id:t.goodsId,rules:t.form.goodsList.map((function(e){var i={option_id:e.id,activity_price:"0",activity_stock:e.activity_stock,leader_price:e.leader_price||-1,is_join:e.is_join,ladder_price:{}};return t.ladderNum.forEach((function(t,a){i.ladder_price[a+1]=e["activity_price".concat(a+1)]})),i}))},t.$emit("spaceGoods",i),t.handleCancel();case 6:case"end":return e.stop()}}),e)})))()},changeSeckill:function(t){this.form.goodsList.map((function(e){e.is_join=t}))},handleBatchChange:function(){var t=this;this.form.goodsList.forEach((function(e){t.batchData.activity_price1&&(e.activity_price1=t.batchData.activity_price1),t.batchData.activity_price2&&(e.activity_price2=t.batchData.activity_price2),t.batchData.activity_price3&&(e.activity_price3=t.batchData.activity_price3),t.batchData.activity_stock&&(e.activity_stock=t.batchData.activity_stock),e.leader_price=t.batchData.leader_price}))},refreshInput:function(){this.batchData=(0,r.default)((0,r.default)({},this.batchData),{},{activity_stock:"",activity_price1:"",activity_price2:"",activity_price3:"",leader_price:""})}}};e.default=l}}]);