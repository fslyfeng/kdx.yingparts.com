(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20,38],{"09b5":function(t,e,i){"use strict";i("6ebf")},"3a10":function(t,e,i){"use strict";var s=i("4020");const r={getComment:(t,e)=>s["a"].get("/order/comment/list",t,e),confirm:(t,e)=>s["a"].post("/order/create/confirm",t,e),create:(t,e)=>s["a"].post("/order/create/index",t,e),allOrderList:(t,e)=>s["a"].get("/order/list/all",t,e),payOrderList:(t,e)=>s["a"].get("/order/list/pay",t,e),sendOrderList:(t,e)=>s["a"].get("/order/list/send",t,e),pickOrderList:(t,e)=>s["a"].get("/order/list/pick",t,e),finishOrderList:(t,e)=>s["a"].get("/order/list/finish",t,e),refundOrderList:(t,e)=>s["a"].get("/order/refund/list",t,e),orderDetail:(t,e)=>s["a"].get("/order/detail/index",t,e),orderPayList:(t,e)=>s["a"].get("/pay/index",t,e),orderPay:(t,e)=>s["a"].post("/pay/index/pay",t,e),orderPayCheck:(t,e)=>s["a"].post("/pay/index/check",t,e),orderGetTotal:t=>s["a"].post("/order/list/get-total",{},t),orderCancel:(t,e)=>s["a"].post("/order/op/cancel",t,e),orderDelete:(t,e)=>s["a"].post("/order/op/delete",t,e),orderFinish:(t,e)=>s["a"].post("/order/op/finish",t,e),getExpress:(t,e)=>s["a"].get("/order/detail/get-express",t,e),orderRefund:(t,e)=>s["a"].get("/order/refund",t,e),refundSubmit:(t,e)=>s["a"].post("/order/refund/submit",t,e),refundDetail:(t,e)=>s["a"].get("/order/refund/detail",t,e),refundCancel:(t,e)=>s["a"].get("/order/refund/cancel",t,e),getCommentList:(t,e)=>s["a"].get("/order/comment/wait-list",t,e),getCommentGoods:(t,e)=>s["a"].get("/order/comment/write-comment",t,e),submitComment:(t,e)=>s["a"].post("/order/comment/write-comment",t,e)};e["a"]=r},"44f1":function(t,e,i){},5016:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"order-info"},[e("div",{staticClass:"common-title"},[t._v("卡密信息")]),t._l(t.virtual,(function(i,s){return e("div",{key:s,staticClass:"order-bd"},[i.config.length>0?e("ul",{staticClass:"account-cont"},[t._l(i.config,(function(r,o){return e("li",{key:o},[e("div",{staticClass:"contLi",class:{"flex-column":i.is_wrap}},[e("span",{staticClass:"liTit"},[t._v(t._s(r.key)+"：")]),e("span",{staticClass:"liCont",on:{click:function(e){return t.toAccountLink(r.type,i,o)}}},[t._v(t._s(i.data["value"+(o+1)]))])]),e("div",{staticClass:"textBtn flex-end theme-primary-color",class:{is_active:r.ischeck},on:{click:function(e){return t.copyLink(i.data,s,o)}}},[t._v("复制 ")])])})),1==i.use_address?e("li",{staticClass:"item-title"},[t._v(t._s(i.use_address_title))]):t._e(),1==i.use_address?e("li",{staticClass:"content"},[e("div",{staticClass:"contLi"},[e("span",{staticClass:"liLink",on:{click:function(e){return t.toAccountLink("-1",i.use_address_address,"-1")}}},[t._v(t._s(i.use_address_address))])]),e("div",{staticClass:"textBtn flex-end theme-primary-color",class:{is_active:i.ischeck},on:{click:function(e){return t.copyLink(i.use_address_address,s,"-1")}}},[t._v("复制 ")])]):t._e(),1==i.use_description?e("li",{staticClass:"item-title"},[t._v(t._s(i.use_description_title))]):t._e(),1==i.use_description?e("li",{staticClass:"content"},[e("span",{staticClass:"liTit"},[t._v(t._s(i.use_description_remark))])]):t._e()],2):t._e()])}))],2),e("textarea",{attrs:{id:"input"}})])},r=[],o={name:"AccountInfo",props:{orderData:{type:Object,default:()=>{}},orderGoods:{type:Array,default:()=>[]}},data(){return{virtual:[]}},watch:{orderData:{handler(t){t&&t.virtual_account_data&&this.isCheck()},immediate:!0}},methods:{isCheck(){var t;this.virtual=(null===(t=this.orderData)||void 0===t?void 0:t.virtual_account_data)||[],this.virtual.length>0&&this.virtual.forEach(t=>{this.$set(t,"ischeck",!1);let e=JSON.parse(t.config),i=JSON.parse(t.data);e.length>0&&e.forEach((e,s)=>{this.$set(e,"ischeck",!1),i["value"+(s+1)].length>28&&this.$set(t,"is_wrap",!0)}),t.config=e,t.data=i})},copyLink(t,e,i){let s="";s="-1"!=i?t["value"+(i+1)]:t;var r=document.getElementById("input");r.value=s,r.select(),document.execCommand("copy"),this.$Message.success("复制成功"),"-1"==i?this.virtual[e].ischeck=!0:this.virtual[e].config[i].ischeck=!0,setTimeout(()=>{"-1"==i?this.virtual[e].ischeck=!1:this.virtual[e].config[i].ischeck=!1},500)}}},a=o,d=(i("09b5"),i("2877")),l=Object(d["a"])(a,s,r,!1,null,"41658d8c",null);e["default"]=l.exports},"6ebf":function(t,e,i){},dff4:function(t,e,i){"use strict";i("44f1")},fb84:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("Container",[e("div",{staticClass:"breadcrumd-css"},[e("Breadcrumbs",{attrs:{list:t.list}})],1),e("div",{staticClass:"order-status"},[t.isRefundSuc?e("div",{staticClass:"status-name"},[t._v("订单状态：售后完成")]):e("div",{staticClass:"status-name"},[t._v("订单状态："+t._s(t.orderDetail.status_text||""))]),t.orderStatus>-1?e("div",{staticClass:"status-bd"},[e("ul",{staticClass:"flex"},t._l(t.orderStatusList,(function(i,s){return e("li",{key:s,class:[t.orderStatus===s?"now":""]},[e("div",{staticClass:"line",class:[t.orderStatus>s?"active":"",s+1==t.orderStatusList.length?"small":""]},[t.orderStatus>=s?e("i",{staticClass:"iconfont icon-yiwancheng1"}):e("i",{staticClass:"iconfont icon-weiwancheng"}),t.orderStatus===s?e("div",{staticClass:"arrow"},[e("i",{staticClass:"iconfont",class:[i.icon]}),t.orderStatus<s?e("div",{staticClass:"arrow-icon"}):t._e()]):t._e()]),e("div",{staticClass:"info"},[e("div",[t._v(t._s(i.name))]),e("div",{staticClass:"time"},[t._v(t._s(i.time||""))])])])})),0)]):t._e()]),"30"===t.orderDetail.status&&t.orderDetail.goods_info&&"1"===t.orderDetail.goods_info[0].type&&"1"===t.orderDetail.goods_info[0].auto_deliver&&t.orderDetail.goods_info[0].auto_deliver_content?e("div",{staticClass:"order-info"},[e("div",{staticClass:"common-title"},[t._v("发货信息")]),e("div",{staticClass:"order-bd"},[e("ul",[e("li",{staticClass:"flex between"},[e("div",{staticClass:"left"},[t._v(t._s(t.orderDetail.goods_info[0].auto_deliver_content))]),e("input",{staticClass:"left",staticStyle:{visibility:"hidden"},attrs:{id:"copyText"},domProps:{value:t.orderDetail.goods_info[0].auto_deliver_content}}),e("div",{staticClass:"right",on:{click:t.handleCopy}},[t._v("复制")])])])])]):t._e(),"30"==t.orderDetail.status&&t.orderDetail.goods_info&&"2"==t.orderDetail.goods_info[0].type?e("div",[e("accountInfo",{attrs:{orderData:t.orderDetail,orderGoods:t.orderDetail.goods_info}})],1):t._e(),e("div",{staticClass:"order-info"},[e("div",{staticClass:"common-title"},[t._v("订单信息")]),e("div",{staticClass:"order-bd"},[e("ul",[e("li",{staticClass:"flex"},[e("div",[t._v("订单编号：")]),e("div",[t._v(t._s(t.orderDetail.order_no))])]),e("li",{staticClass:"flex"},[e("div",[t._v("下单日期：")]),e("div",[t._v(t._s(t.orderDetail.create_time))])]),e("li",{staticClass:"flex"},[e("div",[t._v("支付时间：")]),e("div",[t._v(t._s(t.orderDetail.pay_time))])]),e("li",{staticClass:"flex"},[e("div",[t._v("支付方式：")]),e("div",[t._v(t._s(t.orderDetail.pay_type_text))])]),t._v(" "),e("li",{staticClass:"flex"},[e("div",[t._v("订单金额：")]),e("div",{staticClass:"money"},[t._v("￥"+t._s(t.orderDetail.goods_price))])]),t.orderDetail.buyer_remark?e("li",{staticClass:"flex"},[e("div",[t._v("买家备注：")]),e("div",[t._v(t._s(t.orderDetail.buyer_remark))])]):t._e()])])]),"20"!==t.orderDetail.dispatch_type&&t.orderDetail.goods_info&&"0"===t.orderDetail.orderGoods[0].type?e("div",{staticClass:"address-info"},[e("div",{staticClass:"common-title"},[t._v("收货信息")]),e("ul",[e("li",{staticClass:"flex"},[e("div",[t._v("收货人：")]),e("div",[t._v(t._s(t.orderDetail.buyer_name))])]),e("li",{staticClass:"flex"},[e("div",[t._v("联系电话：")]),e("div",[t._v(t._s(t.orderDetail.buyer_mobile))])]),e("li",{staticClass:"flex"},[e("div",[t._v("收货地址：")]),e("div",[t._v(t._s(t.orderDetail.address_province)+t._s(t.orderDetail.address_city)+t._s(t.orderDetail.address_area)+t._s(t.orderDetail.address_detail)+" ")])])])]):t._e(),e("div",{staticClass:"goods-info"},[e("div",{staticClass:"common-title"},[t._v("商品信息")]),e("ul",{staticClass:"goods"},t._l(t.orderDetail.orderGoods,(function(i,s){return e("li",{key:s,staticClass:"flex"},[e("div",{staticClass:"goods-img"},[e("img",{attrs:{src:t.$utils.mediaUrl(i.thumb)}})]),e("div",{staticClass:"goods-msg"},[e("p",{staticClass:"line2"},[t._v(t._s(i.title))]),e("div",{staticClass:"info"},[t._v(" "+t._s(i.option_title||"默认")+" "),e("span",{staticClass:"cart-num"},[t._v("x"+t._s(i.total))])]),e("div",{staticClass:"price"},[e("span",{staticClass:"money"},[t._v("￥"+t._s(i.price))])])])])})),0),e("ul",{staticClass:"info"},[e("li",{staticClass:"flex"},[e("div",[t._v("运费:")]),t.orderDetail.dispatch_price?e("div",[t._v("¥"+t._s(Number(t.orderDetail.dispatch_price)))]):t._e()]),t._l(t.orderDetail.extra_price_package_text,(function(i,s){return e("li",{key:s,staticClass:"price flex"},[e("div",[t._v(t._s(s)+":")]),e("div",[t._v("-¥"+t._s(i))])])}))],2)]),e("div",{staticClass:"button-box"},[e("div",[t._v(" 共"+t._s(t.goodsTotal)+"件商品，订单总金额为："),e("span",{staticClass:"money"},[t._v("￥"),e("b",[t._v(t._s(t.orderDetail.pay_price))])])]),e("div",{staticClass:"flex button"},[0==t.orderDetail.status?e("Button",{class:t.orderDetail.is_buy?"disabled":"border-primary theme-primary-color theme-primary-border",attrs:{type:"error"},on:{click:function(e){return e.stopPropagation(),t.btnClick("payOrder")}}},[t._v("去支付 ")]):t._e(),(20==t.orderDetail.status&&"0"===t.orderDetail.goods_info[0].type||11==t.orderDetail.status||30==t.orderDetail.status)&&"10"===t.orderDetail.dispatch_type?e("Button",{on:{click:function(e){return e.stopPropagation(),t.btnClick("express")}}},[t._v("查看物流 ")]):t._e(),20==t.orderDetail.status?e("Button",{staticClass:"border-primary theme-primary-color theme-primary-border",on:{click:function(e){return e.stopPropagation(),t.btnClick("sendOrder")}}},[t._v("确认收货 ")]):t._e(),t.canShowAll&&"1"!=t.orderDetail.refund_type?e("Button",{staticClass:"border-primary theme-primary-color theme-primary-border",on:{click:function(e){return e.stopPropagation(),t.btnClick("refundOrder")}}},[t._v("申请退款 ")]):t._e(),"1"===t.orderDetail.refund_type?e("Button",{on:{click:function(e){return t.btnClick("refundDetail")}}},[t._v("售后详情")]):t._e(),30==t.orderDetail.status&&1==t.is_comment&&0==t.orderDetail.comment_status&&"5"!==t.orderDetail.activity_type?e("Button",{staticClass:"border-primary theme-primary-color theme-primary-border",on:{click:function(e){return e.stopPropagation(),t.btnClick("comment")}}},[t._v("立即评价 ")]):t._e()],1)]),e("Modal",{attrs:{width:"360","class-name":"cancelBox"},model:{value:t.showTake,callback:function(e){t.showTake=e},expression:"showTake"}},[e("div",{staticStyle:{"text-align":"center",height:"60px","line-height":"60px"}},[e("p",[t._v("确认收到所有商品了吗？")])]),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{size:"large",type:"info",long:"",loading:t.modal_loading},on:{click:t.confirmGoods}},[t._v("确认收货")])],1)])],1)},r=[],o=i("3a10"),a=i("5016"),d={name:"orderDetial",components:{accountInfo:a["default"]},data(){return{orderDetail:{},showTake:!1,modal_loading:!1,is_comment:0,list:[{name:"首页",path:"/"},{name:"个人中心",path:"/member"},{name:"我的订单",path:"/member/order"},{name:"订单详情"}],orderStatusList:[{icon:"icon-daifukuan",name:"待付款",steps:0,time:"2022-01-02"},{icon:"icon-daifahuo",name:"待发货",steps:1,time:"2022-01-02"},{icon:"icon-daishouhuo",name:"待收货",steps:2},{icon:"icon-yiwancheng",name:"已完成",steps:3}],orderStatus:0}},created(){this.getData()},mounted(){window.history&&window.history.pushState&&window.addEventListener("popstate",this.goBack,!1)},methods:{btnClick(t){switch(t){case"payOrder":this.$router.push({path:"/order/payment",query:{order_id:this.orderDetail.id}});break;case"express":this.$router.push({path:"/order/package",query:{package_id:this.orderDetail.orderGoods[0].package_id,order_id:this.orderDetail.orderGoods[0].order_id}});break;case"sendOrder":this.showTake=!0;break;case"refundOrder":this.$router.push({path:"/order/refund",query:{order_id:this.orderDetail.id}});break;case"refundDetail":this.$router.push({path:"/order/refundDetail",query:{order_id:this.orderDetail.id}});break;case"comment":this.orderDetail.goods_info.length>1?this.$router.push({path:"/order/commentList",query:{order_id:this.$route.query.order_id}}):this.$router.push({path:"/order/comment",query:{id:this.orderDetail.goods_info[0].order_goods_id}});break}},confirmGoods(){this.modal_loading=!0,o["a"].orderFinish({id:this.$route.query.order_id},{hideSuccessTip:!0,success:t=>{0==t.error&&(this.showTake=!1,this.modal_loading=!1,this.$Message.success("确认收货成功"),this.getData())},fail:()=>{this.showTake=!1,this.modal_loading=!1}}),setTimeout(()=>{this.modal_loading=!1},3e3)},handleCopy(){if(this.orderDetail.goods_info[0].auto_deliver_content){var t=document.getElementById("copyText");t.select(),document.execCommand("Copy"),this.$Message.success("复制成功")}},getData(){o["a"].orderDetail({order_id:this.$route.query.order_id},{hideSuccessTip:!0,success:t=>{0==t.error&&(this.orderDetail=t,this.is_comment=t.comment_setting.order_comment,this.setOrderStatus())}})},setOrderStatus(){switch(this.orderDetail.status){case"10":this.orderStatus=1;break;case"0":this.orderStatus=0;break;case"20":this.orderStatus=2;break;case"30":this.orderStatus=3;break;default:this.orderStatus=-1;break}},goBack(){this.$router.push("/member/order")},checkOrderSts({status:t}){let e=!0;if("30"===t)e=this.allowFinish;else if("-1"==t)e=!1;else{let i=["10","11","20"];e=i.indexOf(t)>-1}return e}},computed:{isRefundSuc(){let t=!1;return this.orderDetail&&(t="10"==this.orderDetail.refund_status||"11"==this.orderDetail.refund_status||!1),t},goodsTotal(){return this.orderDetail.orderGoods?this.orderDetail.orderGoods.length:"1"},allowFinish(){var t;return 1===(null===(t=this.orderDetail.refund_setting)||void 0===t?void 0:t.refund_time_status)},canShowAll(){return this.checkOrderSts(this.orderDetail)&&this.hasIntersect&&!("20"===this.orderDetail.status&&"30"===this.orderDetail.dispatch_type)},hasIntersect(){let t={exchange:"1",refund:"1",return:"1"};return this.orderDetail.orderGoods.forEach(e=>{Object.keys(t).forEach(i=>{"1"!=e.refund_rule[i]&&delete t[i]})}),Object.keys(t).length>0},orderCoupon(){var t,e;let i=(null===(t=this.orderDetail)||void 0===t||null===(e=t.activity_return_data)||void 0===e?void 0:e.coupon)||[];return i},couponPrice(){var t,e;return null!==(t=this.orderDetail)&&void 0!==t&&null!==(e=t.extra_price_package)&&void 0!==e&&e.coupon?this.orderDetail.extra_price_package.coupon:0},priceRules(){var t;let e={};if(null!==(t=this.orderDetail)&&void 0!==t&&t.extra_price_package)for(let i in this.orderDetail.extra_price_package)this.orderDetail.extra_discount_rules_package.forEach(t=>{t[i]&&(e={...e,[i]:t[i]})});return e},balance_text(){var t,e;return(null===(t=this.$store.state.setting)||void 0===t||null===(e=t.systemSetting)||void 0===e?void 0:e.balance_text)||"余额"},credit_text(){var t,e;return(null===(t=this.$store.state.setting)||void 0===t||null===(e=t.systemSetting)||void 0===e?void 0:e.credit_text)||"积分"},seckillPrice(){var t;return null===(t=this.orderDetail.extra_price_package)||void 0===t?void 0:t.seckill},price(){var t;return(null===(t=this.orderDetail)||void 0===t?void 0:t.extra_price_package)||{}},priceList(){var t,e,i,s,r,o,a,d,l,c,n,u,h,_,v,p,m,f,g,D,y,C,k,b,x,w,S,$,O,L,T,B,F,G,P,E;let R,q=[],I=this.orderDetail.goods_info,{pay_credit:N}=this.orderDetail,A="￥"+parseFloat(this.orderDetail.goods_price).toFixed(2);return N&&(A=`${this.orderDetail.pay_credit}${this.credit_text}+${A}`),I&&I.length>0&&(R=I[0].type),q=[{title:"商品小计",price:A,show:this.orderDetail&&(this.orderDetail.goods_price||N)},{title:"拼团优惠",price:"-￥"+parseFloat(null===(t=this.price)||void 0===t?void 0:t.groups).toFixed(2),show:(null===(e=this.price)||void 0===e?void 0:e.groups)>0},{title:"团长优惠",price:"-￥"+parseFloat(null===(i=this.price)||void 0===i?void 0:i.groups_leader).toFixed(2),show:(null===(s=this.price)||void 0===s?void 0:s.groups_leader)>0},{title:"会员优惠",price:"-￥"+(null===(r=this.price)||void 0===r?void 0:r.member_price),show:this.price&&this.price.member_price},{title:"优惠券",price:"-￥"+(null===(o=this.price)||void 0===o?void 0:o.coupon),desc:`（满￥${null===this||void 0===this||null===(a=this.priceRules)||void 0===a||null===(d=a.coupon)||void 0===d?void 0:d.enough}${1==(null===this||void 0===this||null===(l=this.priceRules)||void 0===l||null===(c=l.coupon)||void 0===c?void 0:c.coupon_sale_type)?"减￥":"享"}${null===this||void 0===this||null===(n=this.priceRules)||void 0===n||null===(u=n.coupon)||void 0===u?void 0:u.discount_price}${1==(null===this||void 0===this||null===(h=this.priceRules)||void 0===h||null===(_=h.coupon)||void 0===_?void 0:_.coupon_sale_type)?"":"折"}）`,show:this.price&&this.price.coupon},{title:"商城优惠",price:"-￥"+(null===(v=this.price)||void 0===v?void 0:v.full_deduct),desc:`（单笔满￥${null===this||void 0===this||null===(p=this.priceRules)||void 0===p||null===(m=p.full_deduct)||void 0===m?void 0:m.enough}立减￥${null===this||void 0===this||null===(f=this.priceRules)||void 0===f||null===(g=f.full_deduct)||void 0===g?void 0:g.deduct}）`,show:this.price&&this.price.full_deduct},{title:"满减/折",price:"-￥"+(null===(D=this.price)||void 0===D?void 0:D.full_reduce),desc:"",show:this.price&&this.price.full_reduce},{title:this.credit_text+"抵扣",price:"-￥"+(null===(y=this.orderDetail)||void 0===y?void 0:y.max_deduction_credit_money),show:(null===(C=this.orderDetail)||void 0===C?void 0:C.max_deduction_credit)>0&&1==(null===(k=this.confirmData)||void 0===k?void 0:k.deduct_credit)},{title:this.balance_text+"抵扣",price:"-￥"+(null===(b=this.orderDetail)||void 0===b?void 0:b.max_deduction_balance),show:(null===(x=this.orderDetail)||void 0===x?void 0:x.max_deduction_balance)>0&&1==(null===(w=this.confirmData)||void 0===w?void 0:w.deduct_balance)},{title:0==(null===this||void 0===this||null===(S=this.presellData)||void 0===S?void 0:S.presell_type)?"定金抵扣优惠":"预售优惠",price:"-￥"+(null===this||void 0===this||null===($=this.presellData)||void 0===$?void 0:$.actual_deduct),show:(null===this||void 0===this?void 0:this.presellData)&&(null===this||void 0===this||null===(O=this.presellData)||void 0===O?void 0:O.title)},{title:"秒杀优惠",price:"-￥"+(null===this||void 0===this?void 0:this.seckillPrice),show:(null===this||void 0===this?void 0:this.seckillPrice)>0},{title:null===(L=this.giftSetting)||void 0===L?void 0:L.card_title,price:"-￥"+(null===(T=this.price)||void 0===T?void 0:T.gift_card),show:this.price&&this.price.gift_card},{title:"运费",price:"￥"+(parseFloat(null===(B=this.orderDetail)||void 0===B?void 0:B.dispatch_price)||0),desc:"30"==(null===(F=this.orderDetail)||void 0===F?void 0:F.dispatch_type)?` （${this.dispatchName[30]?this.dispatchName[30]:"同城配送"}）`:"",show:0==R&&"20"!=(null===(G=this.orderDetail)||void 0===G?void 0:G.dispatch_type)},{title:"合计",price:"￥"+parseFloat(Number(this.orderDetail.pay_price)+Number((null===(P=this.presellData)||void 0===P?void 0:P.front_money)||0)).toFixed(2),show:(null===this||void 0===this?void 0:this.presellData)&&0==(null===this||void 0===this||null===(E=this.presellData)||void 0===E?void 0:E.presell_type)}],q=q.filter(t=>t.show),q}},beforeDestroy(){window.removeEventListener("popstate",this.goBack,!1)}},l=d,c=(i("dff4"),i("2877")),n=Object(c["a"])(l,s,r,!1,null,"24c1b8c5",null);e["default"]=n.exports}}]);