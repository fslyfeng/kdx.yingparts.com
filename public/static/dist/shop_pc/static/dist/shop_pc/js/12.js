(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"3a10":function(t,e,s){"use strict";var a=s("4020");const i={getComment:(t,e)=>a["a"].get("/order/comment/list",t,e),confirm:(t,e)=>a["a"].post("/order/create/confirm",t,e),create:(t,e)=>a["a"].post("/order/create/index",t,e),allOrderList:(t,e)=>a["a"].get("/order/list/all",t,e),payOrderList:(t,e)=>a["a"].get("/order/list/pay",t,e),sendOrderList:(t,e)=>a["a"].get("/order/list/send",t,e),pickOrderList:(t,e)=>a["a"].get("/order/list/pick",t,e),finishOrderList:(t,e)=>a["a"].get("/order/list/finish",t,e),refundOrderList:(t,e)=>a["a"].get("/order/refund/list",t,e),orderDetail:(t,e)=>a["a"].get("/order/detail/index",t,e),orderPayList:(t,e)=>a["a"].get("/pay/index",t,e),orderPay:(t,e)=>a["a"].post("/pay/index/pay",t,e),orderPayCheck:(t,e)=>a["a"].post("/pay/index/check",t,e),orderGetTotal:t=>a["a"].post("/order/list/get-total",{},t),orderCancel:(t,e)=>a["a"].post("/order/op/cancel",t,e),orderDelete:(t,e)=>a["a"].post("/order/op/delete",t,e),orderFinish:(t,e)=>a["a"].post("/order/op/finish",t,e),getExpress:(t,e)=>a["a"].get("/order/detail/get-express",t,e),orderRefund:(t,e)=>a["a"].get("/order/refund",t,e),refundSubmit:(t,e)=>a["a"].post("/order/refund/submit",t,e),refundDetail:(t,e)=>a["a"].get("/order/refund/detail",t,e),refundCancel:(t,e)=>a["a"].get("/order/refund/cancel",t,e),getCommentList:(t,e)=>a["a"].get("/order/comment/wait-list",t,e),getCommentGoods:(t,e)=>a["a"].get("/order/comment/write-comment",t,e),submitComment:(t,e)=>a["a"].post("/order/comment/write-comment",t,e)};e["a"]=i},"5b12":function(t,e,s){"use strict";s("e590")},"6a7b":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"order-box"},[e("div",{staticClass:"member-order"},[e("ul",{staticClass:"order-nav flex"},t._l(t.navList,(function(s,a){return e("li",{key:a,class:[a==t.activeIndex?"active":""],on:{click:function(e){return t.selectNav(s,a)}}},[t._v(" "+t._s(s.name)+" "),e("span",{directives:[{name:"show",rawName:"v-show",value:s.num,expression:"nav.num"}]},[t._v("("+t._s(s.num)+")")])])})),0),t.orderList.length>0?e("div",{staticClass:"order-list"},[5!=t.activeIndex?e("ul",t._l(t.orderList,(function(s,a){return e("li",{key:a,staticClass:"item"},[e("div",{staticClass:"item-top flex"},[t._v(" "+t._s(s.create_time)+" "),s.buyer_name?e("p",[t._v(" 收件人："+t._s(s.buyer_name)+" ")]):t._e(),s.order_no?e("p",[t._v("订单号:"+t._s(s.order_no))]):t._e(),"0"!=s.pay_type?e("p",[t._v("支付方式:"+t._s(t._f("payTypeFilter")(s.pay_type)))]):t._e()]),e("div",{staticClass:"item-goods",on:{click:function(e){return t.toDetail(s)}}},[e("div",t._l(s.orderGoods,(function(s,a){return e("div",{key:a,staticClass:"flex goodsItem"},[e("img",{attrs:{src:t.$utils.mediaUrl(s.thumb),alt:""}}),e("div",{staticClass:"goods"},[e("p",{staticClass:"name"},[t._v(t._s(s.title))]),e("span",{staticClass:"type"},[t._v(t._s(s.option_title||"默认"))]),e("div",{staticClass:"flex"},[e("span",{staticClass:"price"},[t._v("¥"+t._s(s.price_unit))]),e("span",{staticClass:"total"},[t._v("x "+t._s(s.total))])])])])})),0),e("div",{staticClass:"status"},[s.refund_finish&&"1"==s.refund_finish?e("span",{staticClass:"success"},[t._v("售后完成")]):e("span",[0==s.status?e("span",{staticClass:"status uni-color-primary"},[t._v("待付款")]):t._e(),10==s.status?e("span",{staticClass:"status"},[t.isLoadGroups(s)?e("span",{staticClass:"primary"},[t._v("待成团")]):e("span",{staticClass:"orange"},[t._v("待发货")])]):t._e(),11==s.status?e("span",{staticClass:"status orange"},[t._v("部分发货")]):t._e(),20==s.status&&"20"!=s.dispatch_type?e("span",{staticClass:"status blue"},[t._v("待收货")]):t._e(),20==s.status&&"20"===s.dispatch_type?e("span",{staticClass:"status blue"},[t._v(t._s("0"==s.orderGoods[0].type?"待自提":"待核销"))]):t._e(),30==s.status?e("span",{staticClass:"status success"},[t._v("已完成")]):t._e(),-1==s.status?e("span",{staticClass:"status"},[t._v("已关闭")]):t._e()])])]),e("div",{staticClass:"item-button"},[e("div",{staticClass:"price flex"},[t._v(" 共"+t._s(s.orderGoods.length)+"件商品，总金额 "),e("p",[t._v("￥"+t._s(s.pay_price))])]),e("div",{staticClass:"button flex"},[t.showFooterBtn(s)?e("div",{staticClass:"card-btn flex"},[s.refund_finish&&"1"==s.refund_finish?e("div",[e("Button",{on:{click:function(e){return e.stopPropagation(),t.btnClick("deleteOrder",s)}}},[t._v("删除订单")])],1):e("div",[0==s.status?e("Button",{on:{click:function(e){return e.stopPropagation(),t.orderCancel(s)}}},[t._v(" 取消订单 ")]):t._e(),0==s.status?e("Button",{class:s.is_buy?"disabled":"border-primary theme-primary-color theme-primary-border",attrs:{type:"error"},on:{click:function(e){return e.stopPropagation(),t.btnClick("payOrder",s)}}},[t._v("去支付 ")]):t._e(),(20==s.status&&"0"===s.orderGoods[0].type||11==s.status||30==s.status)&&"10"===s.dispatch_type?e("Button",{on:{click:function(e){return e.stopPropagation(),t.btnClick("express",s)}}},[t._v("查看物流 ")]):t._e(),20==s.status?e("Button",{staticClass:"border-primary theme-primary-color theme-primary-border",on:{click:function(e){return e.stopPropagation(),t.btnClick("sendOrder",s)}}},[t._v("确认收货 ")]):t._e(),30==s.status||-1==s.status?e("Button",{on:{click:function(e){return e.stopPropagation(),t.orderDelete(s)}}},[t._v("删除订单 ")]):t._e(),30==s.status&&1==t.is_comment&&0==s.comment_status&&"5"!==s.activity_type?e("Button",{staticClass:"border-primary theme-primary-color theme-primary-border",on:{click:function(e){return e.stopPropagation(),t.btnClick("comment",s)}}},[t._v("评价 ")]):t._e()],1)]):t._e()])])])})),0):e("ul",t._l(t.orderList,(function(s,a){return e("li",{key:a,staticClass:"item"},[e("div",{staticClass:"item-top flex"},[t._v(" "+t._s(s.create_time)+" "),s.order_no?e("p",[t._v("订单号:"+t._s(s.order_no))]):t._e()]),e("div",{staticClass:"item-goods",on:{click:function(e){return t.toDetail(s)}}},[e("div",t._l(s.order_goods,(function(s,a){return e("div",{key:a,staticClass:"flex goodsItem"},[e("img",{attrs:{src:t.$utils.mediaUrl(s.thumb),alt:""}}),e("div",{staticClass:"goods"},[e("p",{staticClass:"name"},[t._v(t._s(s.title))]),e("span",{staticClass:"type"},[t._v(t._s(s.option_title||"默认"))]),e("div",{staticClass:"flex"},[e("span",{staticClass:"price"},[t._v("¥"+t._s(s.price))])])])])})),0),e("div",{staticClass:"status"},[-1==s.status?e("span",{},[t._v("售后失败")]):t._e(),s.status>=0&&s.status<=9?e("span",{staticClass:"blue"},[t._v("申请售后中")]):t._e(),10==s.status||11==s.status?e("span",{staticClass:"success"},[t._v("售后完成")]):t._e()])]),e("div",{staticClass:"item-button"},[s.order_goods?e("div",{staticClass:"price flex"},[t._v(" 共"+t._s(s.order_goods.length)+"件商品，总金额 "),e("p",[t._v("￥"+t._s(s.price))])]):t._e(),e("div",{staticClass:"button flex"},[e("div",{staticClass:"card-btn flex"},[s.status>=0&&s.status<=9?e("Button",{on:{click:function(e){return e.stopPropagation(),t.orderCancelRefund(s)}}},[t._v(" 取消售后 ")]):t._e()],1)])])])})),0),e("div",{staticClass:"order-page"},[e("Page",{attrs:{total:Number(t.total),"page-size":20},on:{"on-change":t.changePage}})],1)]):e("div",[e("EmptyPage")],1)]),e("Modal",{attrs:{width:"360","class-name":"cancelBox"},model:{value:t.showCancel,callback:function(e){t.showCancel=e},expression:"showCancel"}},[e("div",{staticStyle:{"text-align":"center",height:"60px","line-height":"60px"}},[e("p",[t._v("确认取消订单吗？")])]),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"error",size:"large",long:"",loading:t.modal_loading},on:{click:t.del}},[t._v("取消订单")])],1)]),e("Modal",{attrs:{width:"360","class-name":"cancelBox"},model:{value:t.showDelete,callback:function(e){t.showDelete=e},expression:"showDelete"}},[e("div",{staticStyle:{"text-align":"center",height:"60px","line-height":"60px"}},[e("p",[t._v("确认删除订单吗？")])]),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"error",size:"large",long:"",loading:t.modal_loading},on:{click:t.del}},[t._v("删除订单")])],1)]),e("Modal",{attrs:{width:"360","class-name":"cancelBox"},model:{value:t.showTake,callback:function(e){t.showTake=e},expression:"showTake"}},[e("div",{staticStyle:{"text-align":"center",height:"60px","line-height":"60px"}},[e("p",[t._v("确认收到所有商品了吗？")])]),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{size:"large",type:"info",long:"",loading:t.modal_loading},on:{click:t.confirmGoods}},[t._v("确认收货")])],1)]),e("Modal",{attrs:{width:"360","class-name":"cancelBox"},model:{value:t.showRefunCacel,callback:function(e){t.showRefunCacel=e},expression:"showRefunCacel"}},[e("div",{staticStyle:{"text-align":"center",height:"60px","line-height":"60px"}},[e("p",[t._v("您将取消申请售后，确定继续吗？")])]),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{size:"large",type:"info",long:"",loading:t.modal_loading},on:{click:t.refundCancel}},[t._v("取消售后")])],1)])],1)},i=[],r=(s("caad"),s("3a10")),o={name:"order",data(){return{showCancel:!1,showRefunCacel:!1,showDelete:!1,modal_loading:!1,getData_loading:!1,showTake:!1,is_comment:0,apiStatus:{all:"allOrderList",pay:"payOrderList",send:"sendOrderList",pick:"pickOrderList",finish:"finishOrderList",refund:"refundOrderList"},activeIndex:0,navList:[{name:"全部订单",num:"",type:"all"},{name:"待付款",num:"",type:"pay"},{name:"待发货",num:"",type:"send"},{name:"待收货",num:"",type:"pick"},{name:"已完成",num:"",type:"finish"},{name:"售后",num:"",type:"refund"}],orderList:[],pageNumber:1,total:"",btnData:{}}},created(){this.$route.params.status&&(this.activeIndex=this.$route.params.status),this.getOrderList(),this.getOrderStatus()},methods:{handleReachBottom(){return new Promise(t=>{setTimeout(()=>{const e=this.list1[this.list1.length-1];for(let t=1;t<11;t++)this.list1.push(e+t);t()},2e3)})},btnClick(t,e){switch(this.btnData=e,t){case"payOrder":this.$router.push({path:"/order/payment",query:{order_id:e.id}});break;case"express":this.$router.push({path:"/order/package",query:{package_id:this.btnData.orderGoods[0].package_id,order_id:this.btnData.orderGoods[0].order_id}});break;case"sendOrder":this.showTake=!0;break;case"comment":console.log(this.btnData),this.$router.push({path:"/order/commentList",query:{order_id:this.btnData.id}});break}},confirmGoods(){this.modal_loading=!0,r["a"].orderFinish({id:this.btnData.id},{hideSuccessTip:!0,success:t=>{this.showTake=!1,this.modal_loading=!1,0==t.error&&(this.$Message.success("确认收货成功"),this.pageNumber=1,this.getOrderList(),this.getOrderStatus())},fail:()=>{this.showTake=!1,this.modal_loading=!1}}),setTimeout(()=>{this.modal_loading=!1},3e3)},refundCancel(){this.modal_loading=!0,r["a"].refundCancel({order_id:this.btnData.order_id,is_edit:1},{hideSuccessTip:!0,success:t=>{this.showRefunCacel=!1,this.modal_loading=!1,0==t.error&&(this.$Message.success("取消成功"),this.pageNumber=1,this.getOrderList(),this.getOrderStatus())},fail:()=>{this.showRefunCacel=!1,this.modal_loading=!1}}),setTimeout(()=>{this.modal_loading=!1},3e3)},del(){this.modal_loading=!0,console.log(this.showCancel),this.showCancel&&r["a"].orderCancel({id:this.btnData.id},{hideSuccessTip:!0,success:t=>{this.showCancel=!1,this.modal_loading=!1,0==t.error&&(this.$Message.success("取消成功"),this.pageNumber=1,this.getOrderList(),this.getOrderStatus())},fail:()=>{this.showCancel=!1,this.modal_loading=!1}}),this.showDelete&&r["a"].orderDelete({id:this.btnData.id},{hideSuccessTip:!0,success:t=>{this.modal_loading=!1,this.showDelete=!1,0==t.error&&(this.$Message.success("删除成功"),this.pageNumber=1,this.getOrderList(),this.getOrderStatus())},fail:()=>{this.modal_loading=!1,this.showDelete=!1}}),setTimeout(()=>{this.modal_loading=!1},3e3)},orderDelete(t){this.btnData=t,this.showDelete=!0},orderCancel(t){this.btnData=t,this.showCancel=!0},orderCancelRefund(t){this.btnData=t,this.showRefunCacel=!0},showFooterBtn(t){let e=["-1","0","10","11","20","30"];return t.refund_finish&&"1"==t.refund_finish||e.includes(t.status)},isLoadGroups(t){var e,s;return"3"==t.activity_type&&"0"==(null===(e=t.groups_team_info)||void 0===e?void 0:e.success)||"4"==t.activity_type&&"0"==(null===(s=t.groups_rebate_team_info)||void 0===s?void 0:s.success)},getOrderStatus(){r["a"].orderGetTotal({hideSuccessTip:!0,success:t=>{0==t.error&&this.navList.forEach(e=>{"pay"===e.type&&(e.num=t.wait_pay),"send"===e.type&&(e.num=t.wait_send),"pick"===e.type&&(e.num=t.wait_receive),"refund"===e.type&&(e.num=t.refund)})}})},changePage(t){document.documentElement.scrollTop=0,this.pageNumber=t,this.getOrderList()},getOrderList(){if(this.getData_loading)return;this.getData_loading=!0;let t=this.apiStatus[this.navList[this.activeIndex].type];r["a"][t]({page:this.pageNumber},{hideSuccessTip:!0,success:t=>{var e;this.getData_loading=!1,0==t.error&&(this.orderList=t.list,this.total=t.total,this.is_comment=(null===t||void 0===t||null===(e=t.comment_setting)||void 0===e?void 0:e.order_comment)||"")}}),setTimeout(()=>{this.getData_loading=!1},3e3)},toDetail(t){console.log(t,"item"),5!=this.activeIndex?this.$router.push({path:"/order/orderDetail",query:{order_id:t.id}}):this.$router.push({path:"/order/refundDetail",query:{order_id:t.order_id}})},selectNav(t,e){e!=this.activeIndex&&(this.activeIndex=e,this.pageNumber=1,this.getOrderList())},handleScroll(){let t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,e=document.documentElement.offsetHeight,s=document.documentElement.scrollHeight,a=s-e;t+500>a&&!this.modal_loading&&this.orderList.length<this.total&&(console.log("请求数据"),setTimeout(()=>{this.getOrderList()},500))}},filters:{payTypeFilter(t){if(t&&0!==t){let e;switch(t){case"1":e="后台确认";break;case"2":e="余额支付";break;case"3":e="货到付款";break;case"20":e="微信支付";break;case"30":e="支付宝支付";break;default:e="待付款";break}return e}return"待付款"}},mounted(){},destroyed(){}},n=o,l=(s("5b12"),s("2877")),d=Object(l["a"])(n,a,i,!1,null,"5bd68bf1",null);e["default"]=d.exports},e590:function(t,e,s){}}]);